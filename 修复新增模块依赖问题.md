# ä¿®å¤æ–°å¢æ¨¡å—ä¾èµ–é—®é¢˜

## ğŸ” é—®é¢˜åˆ†æ

æ–°å¢çš„æ¨¡å—å¯èƒ½å¯¼è‡´å¯åŠ¨é”™è¯¯ï¼Œä¸»è¦åŒ…æ‹¬ï¼š

1. **MerchantModule** - å•†æˆ·è‡ªåŠ¨åŒ–æ¨¡å—
2. **IntegrationsModule** - é›†æˆæœåŠ¡æ¨¡å—
3. **AutoEarnModule** - Auto-Earnæ¨¡å—ï¼ˆåŒ…å«é«˜çº§åŠŸèƒ½ï¼‰
4. **MarketplaceModule** - Marketplaceæ¨¡å—ï¼ˆåŒ…å«Agent Marketplaceï¼‰

## âœ… æ£€æŸ¥æ¸…å•

### 1. å®ä½“æ–‡ä»¶æ£€æŸ¥

æ‰€æœ‰å¿…éœ€çš„å®ä½“æ–‡ä»¶éƒ½å·²å­˜åœ¨ï¼š
- âœ… `marketing-campaign.entity.ts`
- âœ… `conversation-history.entity.ts`
- âœ… `agent-stats.entity.ts`
- âœ… `strategy-config.entity.ts`

### 2. æ¨¡å—å¯¼å…¥æ£€æŸ¥

æ‰€æœ‰æ¨¡å—éƒ½å·²æ­£ç¡®å¯¼å…¥åˆ° `app.module.ts`ï¼š
- âœ… `MerchantModule`
- âœ… `IntegrationsModule`
- âœ… `AutoEarnModule`
- âœ… `MarketplaceModule`

### 3. ä¾èµ–æ³¨å…¥æ£€æŸ¥

æ‰€æœ‰æœåŠ¡éƒ½æ­£ç¡®ä½¿ç”¨ `@InjectRepository` æ³¨å…¥å®ä½“ï¼š
- âœ… `MerchantAutoOrderService`
- âœ… `MerchantAICustomerService`
- âœ… `MerchantAutoMarketingService`
- âœ… `StrategyService`
- âœ… `AgentMarketplaceService`

## ğŸ› å¯èƒ½çš„å¯åŠ¨é”™è¯¯

### é”™è¯¯1: æ•°æ®åº“è¡¨ä¸å­˜åœ¨

**ç—‡çŠ¶**: 
```
relation "marketing_campaigns" does not exist
relation "conversation_histories" does not exist
relation "agent_stats" does not exist
relation "strategy_configs" does not exist
```

**è§£å†³æ–¹æ¡ˆ**: è¿è¡Œæ•°æ®åº“è¿ç§»

```bash
cd backend
npm run migration:run
```

### é”™è¯¯2: å¾ªç¯ä¾èµ–

**ç—‡çŠ¶**:
```
Nest can't resolve dependencies of the StrategyService
```

**è§£å†³æ–¹æ¡ˆ**: æ£€æŸ¥ `StrategyService` çš„ä¾èµ–æ³¨å…¥

`StrategyService` ä¾èµ– `ArbitrageService` å’Œ `LaunchpadService`ï¼Œä½†è¿™äº›æœåŠ¡éƒ½åœ¨åŒä¸€ä¸ªæ¨¡å—ä¸­ï¼Œåº”è¯¥æ²¡é—®é¢˜ã€‚

å¦‚æœå‡ºç°å¾ªç¯ä¾èµ–ï¼Œéœ€è¦ï¼š
1. ä½¿ç”¨ `forwardRef()` è§£å†³
2. æˆ–è€…é‡æ„æœåŠ¡ä¾èµ–å…³ç³»

### é”™è¯¯3: å®ä½“æœªæ³¨å†Œ

**ç—‡çŠ¶**:
```
EntityMetadataNotFoundError: No metadata for "MarketingCampaign"
```

**è§£å†³æ–¹æ¡ˆ**: ç¡®ä¿å®ä½“åœ¨æ¨¡å—ä¸­æ­£ç¡®æ³¨å†Œ

æ£€æŸ¥ `MerchantModule`:
```typescript
TypeOrmModule.forFeature([Payment, Product, Coupon, MarketingCampaign, ConversationHistory])
```

æ£€æŸ¥ `AutoEarnModule`:
```typescript
TypeOrmModule.forFeature([UserAgent, AutoEarnTask, Airdrop, StrategyConfig])
```

æ£€æŸ¥ `MarketplaceModule`:
```typescript
TypeOrmModule.forFeature([MarketplaceAsset, AssetSource, UserAgent, AgentStats])
```

## ğŸ”§ å¿«é€Ÿä¿®å¤æ­¥éª¤

### æ­¥éª¤1: è¿è¡Œæ•°æ®åº“è¿ç§»

```bash
cd backend
npm run migration:run
```

### æ­¥éª¤2: æ£€æŸ¥ç¼–è¯‘

```bash
npm run build
```

### æ­¥éª¤3: å¯åŠ¨æœåŠ¡

```bash
npm run start:dev
```

### æ­¥éª¤4: å¦‚æœä»æœ‰é”™è¯¯

æŸ¥çœ‹å…·ä½“é”™è¯¯ä¿¡æ¯ï¼Œå¯èƒ½æ˜¯ï¼š
- å®ä½“å¯¼å…¥è·¯å¾„é”™è¯¯
- æœåŠ¡ä¾èµ–æ³¨å…¥é”™è¯¯
- æ¨¡å—å¯¼å…¥é¡ºåºé—®é¢˜

## ğŸ“‹ éªŒè¯æ¸…å•

- [ ] æ‰€æœ‰å®ä½“æ–‡ä»¶å­˜åœ¨
- [ ] æ‰€æœ‰æ¨¡å—æ­£ç¡®å¯¼å…¥åˆ° `app.module.ts`
- [ ] æ‰€æœ‰å®ä½“åœ¨æ¨¡å—ä¸­æ­£ç¡®æ³¨å†Œ
- [ ] æ•°æ®åº“è¿ç§»å·²æ‰§è¡Œ
- [ ] æ— ç¼–è¯‘é”™è¯¯
- [ ] æ— å¾ªç¯ä¾èµ–

---

**å¦‚æœå¯åŠ¨å¤±è´¥ï¼Œè¯·æä¾›å®Œæ•´çš„é”™è¯¯æ—¥å¿—ã€‚**

