#!/bin/bash

# å¿«é€Ÿé‡Šæ”¾ç«¯å£3000å¹¶å¯åŠ¨å‰ç«¯æœåŠ¡

echo "=========================================="
echo "ğŸ”§ é‡Šæ”¾ç«¯å£3000å¹¶å¯åŠ¨å‰ç«¯æœåŠ¡"
echo "=========================================="
echo ""

# æŸ¥æ‰¾å¹¶æ€æ­»å ç”¨3000ç«¯å£çš„è¿›ç¨‹
echo "[1/4] æŸ¥æ‰¾å ç”¨3000ç«¯å£çš„è¿›ç¨‹..."
PID=$(lsof -ti:3000 2>/dev/null)

if [ -n "$PID" ]; then
    echo "æ‰¾åˆ°è¿›ç¨‹: $PID"
    echo "[2/4] æ€æ­»è¿›ç¨‹..."
    kill -9 $PID 2>/dev/null
    sleep 2
    echo "âœ… è¿›ç¨‹å·²ç»ˆæ­¢"
else
    echo "âœ… ç«¯å£3000æœªè¢«å ç”¨"
fi

# æ¸…é™¤ç¼“å­˜
echo "[3/4] æ¸…é™¤Next.jsç¼“å­˜..."
cd paymindfrontend
rm -rf .next
echo "âœ… ç¼“å­˜å·²æ¸…é™¤"

# å¯åŠ¨æœåŠ¡
echo "[4/4] å¯åŠ¨å‰ç«¯æœåŠ¡..."
echo ""
echo "å‰ç«¯å°†åœ¨ http://localhost:3000 å¯åŠ¨"
echo "Agenté¡µé¢: http://localhost:3000/agent"
echo ""
npm run dev

