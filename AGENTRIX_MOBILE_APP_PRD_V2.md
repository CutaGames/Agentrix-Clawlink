# Agentrix 移动端 App PRD

**版本**: 2.0  
**日期**: 2026-02-01  
**状态**: Review  
**负责人**: 产品/研发/设计

---

## 修订记录

| 版本 | 日期 | 修订内容 | 作者 |
|-----|------|---------|-----|
| 1.0 | 2026-02-01 | 初稿 | PM |
| 2.0 | 2026-02-01 | 结构重构、补充安全/技术/竞品章节、修复编号冲突 | Copilot |

---

## V1 → V2 核心变化

| 问题 | V1 状态 | V2 改进 |
|-----|---------|--------|
| 章节编号冲突 | 4.6 出现两次，6.1 层级混乱 | 统一编号，功能归类至四层架构 |
| 模块定位不清 | 统一账户/Agent账户 作为仪表盘子项 | 提升为 Layer 1 基础设施 |
| 功能重叠 | 杀手功能 & 传播增长 重复 | 合并为"增长与社交层" |
| 进度过激 | 2 周 MVP 含 8 模块 | 调整为 3 周，聚焦核心 |
| 技术缺失 | 无状态管理/离线/安全 | 补充完整技术架构 |
| 竞品缺失 | 无 | 新增竞品分析 |

---

## 1. 背景与目标

### 1.1 背景
Agentrix 正在构建 **个人 AI Agent 时代的财富管理平台**。每个用户都将拥有自己的 Personal Agent，帮助用户管理数字资产、发现收益机会、自动化理财。移动端是触达个人用户的核心入口。

### 1.2 产品愿景

> **"你的 AI 财富助手，24/7 为你工作"**
> - 自动发现空投机会，一键领取
> - 智能收益策略，睡眠时也在赚钱
> - 统一管理法币+加密资产
> - 个人 Agent 随时待命

### 1.3 目标（可量化）

| 目标 | 成功标准 |
|-----|----------|
| 成为用户首选的个人财富管理入口 | MVP 上线后 30 天 DAU ≥ 2,000 |
| 空投/AutoEarn 功能使用率 | 周活用户使用率 ≥ 40% |
| 用户资产管理规模（AUM） | 3 个月后 ≥ $500 万 |

### 1.4 目标用户画像

#### 核心理念：一人多身份

> 每个用户都是**个人**，可以同时激活**商户**和**开发者**身份。
> 不同身份解锁不同功能，数据在 App 和 Web 间完全互通。

| 身份 | 用户类型示例 | 核心诉求 | 使用频率 | 关键功能 |
|-----|------------|---------|---------|---------|
| **个人** (默认) | 理财用户、Web3 玩家 | 管理资产、获取收益 | 日活 | 资产管理、空投、AutoEarn、Agent |
| **商户** (需激活) | 店主、服务商、创作者 | 收款、分佣、结算 | 日活 | 分佣计划、收款工具、结算账本 |
| **开发者** (需激活) | 自由职业者、外包团队 | 接单、交付、赚钱 | 日活 | 预算池、里程碑、Skill 发布、接单 |

#### 典型用户场景

```
场景 1：自由职业者 Kevin（同时拥有 3 个身份）
├─ 个人身份：查看资产、领空投、AutoEarn 理财
├─ 商户身份：给客户发收款链接，设置分佣规则
└─ 开发者身份：在任务市场接单，交付里程碑，提现收益

场景 2：电商店主 Lisa（个人 + 商户）
├─ 个人身份：管理多链资产，自动理财
└─ 商户身份：管理分佣计划，查看结算账本，分析收入

场景 3：理财小白 Amy（仅个人身份）
└─ 个人身份：连接钱包 → 发现空投 → 一键领取 → 存入 AutoEarn
```

#### 用户画像详情

**👤 画像 1：理财小白（Amy，25岁，白领）**
- 身份：仅个人
- 痛点：有些闲钱想理财，但不懂加密货币，怕亏
- 期望：像余额宝一样简单——存入、自动赚、随时取
- 关键功能：一键理财、风险评级、收益可视化

**👤 画像 2：全能自由职业者（Kevin，28岁，程序员）**
- 身份：个人 + 商户 + 开发者
- 痛点：收入来源多，收款/理财/接单分散在不同平台
- 期望：一个 App 搞定所有，身份自由切换
- 关键功能：空投雷达、收款链接、任务市场、收益汇总

**👤 画像 3：电商创业者（Lisa，32岁，店主）**
- 身份：个人 + 商户
- 痛点：分佣设置复杂，结算对账麻烦
- 期望：手机上快速管理分佣，实时看收入
- 关键功能：分佣计划、收款工具、结算账本、数据分析

**👤 画像 4：DeFi 老手（David，35岁，交易员）**
- 身份：个人
- 痛点：手动操作效率低，想要自动化策略
- 期望：配置策略后自动执行，手机随时监控
- 关键功能：策略引擎、跨链套利、收益分析

### 1.4 竞品分析

| 竞品 | 优势 | 劣势 | Agentrix 差异化 |
|-----|-----|-----|----------------|
| **Stripe Dashboard** | 成熟稳定、数据可视化强 | 无分账、无 Agent 概念 | 原生分账 + Agent 身份 |
| **PayPal Business** | 用户基数大、信任度高 | 费率高、无链上能力 | 加密原生 + 低费率 |
| **Deel / Remote** | 跨境合规、薪资发放 | 仅限雇佣场景 | 任务制 + 里程碑结算 |
| **Superfluid** | 流支付、链上原生 | 无法币入口 | 法币+加密统一账户 |

---

## 2. 产品架构

### 2.1 核心设计原则

#### 2.1.1 统一账户，多身份切换

```
┌─────────────────────────────────────────────────────────────────┐
│                 Agentrix 统一账户体系                            │
│              (App + Web 数据完全互通)                            │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│   ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │
│   │    个人身份      │  │    商户身份      │  │   开发者身份     │ │
│   │   (默认激活)     │  │  (需审核激活)    │  │  (需审核激活)    │ │
│   ├─────────────────┤  ├─────────────────┤  ├─────────────────┤ │
│   │ • 资产管理       │  │ • 分佣计划管理   │  │ • 预算池管理     │ │
│   │ • 空投发现/领取  │  │ • 收款工具       │  │ • 里程碑交付     │ │
│   │ • AutoEarn 理财  │  │ • 结算账本       │  │ • Skill 发布    │ │
│   │ • Personal Agent│  │ • 客户/订单管理  │  │ • 接单/抢单      │ │
│   │ • 消费/支付      │  │ • 数据分析       │  │ • 收益管理       │ │
│   └─────────────────┘  └─────────────────┘  └─────────────────┘ │
│                                                                 │
│   ← 一个用户可同时拥有多个身份，App 内自由切换 →                    │
│   ← Web 端激活的身份，App 自动同步可用 →                           │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

#### 2.1.2 数据互通架构

| 特性 | 说明 |
|-----|-----|
| **统一后端** | App 与 Web 共用同一套 API（backend 3001 端口） |
| **统一账户** | 同一登录态，App/Web 数据实时同步 |
| **身份审核** | 任一端（App/Web）完成审核，全端生效 |
| **功能对等** | App 核心功能与 Web 保持一致（移动端优化交互） |

#### 2.1.3 身份激活规则

| 身份 | 激活方式 | 审核要求 | 说明 |
|-----|---------|---------|-----|
| **个人** | 注册即激活 | 无 | 默认身份，所有用户都有 |
| **商户** | 提交申请 | 需审核 | 审核通过后可使用分佣/收款功能 |
| **开发者** | 提交申请 | 需审核 | 审核通过后可发布 Skill/接单 |

### 2.2 四层模块分层

```
┌─────────────────────────────────────────────────────────────┐
│                    Agentrix Mobile App                      │
├─────────────────────────────────────────────────────────────┤
│  Layer 0: 统一首页 + 身份切换                                 │
│  ┌─────────────────────────────────────────────────────────┐│
│  │  资产总览 | 快捷入口 | 身份切换器 | 待办提醒              ││
│  └─────────────────────────────────────────────────────────┘│
├─────────────────────────────────────────────────────────────┤
│  Layer 1: 个人功能层                                         │
│  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐       │
│  │ 资产管理  │ │ 空投系统  │ │ AutoEarn │ │Personal  │       │
│  │          │ │          │ │          │ │ Agent    │       │
│  └──────────┘ └──────────┘ └──────────┘ └──────────┘       │
├─────────────────────────────────────────────────────────────┤
│  Layer 2: 商户功能层                                         │
│  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐       │
│  │ 分佣计划  │ │ 收款工具  │ │ 结算账本  │ │ 客户管理  │       │
│  └──────────┘ └──────────┘ └──────────┘ └──────────┘       │
├─────────────────────────────────────────────────────────────┤
│  Layer 3: 开发者功能层                                       │
│  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐       │
│  │ 预算池    │ │ 里程碑    │ │ Skill    │ │ 接单中心  │       │
│  │ 管理     │ │ 交付     │ │ 发布     │ │          │       │
│  └──────────┘ └──────────┘ └──────────┘ └──────────┘       │
├─────────────────────────────────────────────────────────────┤
│  Layer 4: 平台服务层                                         │
│  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐       │
│  │ 推送通知  │ │ 钱包连接  │ │ 设置中心  │ │ 身份审核  │       │
│  └──────────┘ └──────────┘ └──────────┘ └──────────┘       │
└─────────────────────────────────────────────────────────────┘
```

### 2.3 MVP 范围界定（三身份核心功能）

| 层级 | MVP 必须 | Phase 2 | Phase 3 |
|-----|---------|---------|---------|
| **统一首页** | 资产总览、身份切换、快捷入口、待办提醒 | 智能推荐 | 个性化配置 |
| **个人功能** | 资产管理、空投发现/领取、AutoEarn（基础）、Agent 对话 | 批量领取、高级策略 | 套利/Copy Trading |
| **商户功能** | 分佣计划列表、收款链接、结算列表、分佣预览 | 计划详情、筛选、数据分析 | 报表导出 |
| **开发者功能** | 预算池列表、里程碑管理、接单列表、收益中心 | Skill 发布、任务市场 | 高级协作 |
| **平台服务** | 钱包连接、设置、身份申请 | 推送通知、审核状态 | 多语言 |

---

## 3. 用户故事（按身份分类）

### 3.1 个人身份故事（P0 - MVP）

#### 资产管理

| ID | 用户故事 | 验收标准 |
|----|---------|---------|
| US-01 | 我希望一眼看到我所有链上的资产总览 | 首页展示总资产（法币+加密），支持多链聚合 |
| US-02 | 我希望查看每条链的详细余额和代币 | 按链分组展示，支持代币搜索 |
| US-03 | 我希望查看我的交易流水和历史记录 | 按时间倒序，支持类型筛选 |

#### 空投系统

| ID | 用户故事 | 验收标准 |
|----|---------|---------|
| US-04 | 我希望自动发现我有资格领取的空投 | 空投列表按价值/截止时间排序，显示资格状态 |
| US-05 | 我希望一键领取空投 | 点击领取 → 确认 → 链上交易 → 到账通知 |
| US-06 | 我希望了解每个空投的风险等级 | 显示风险评分 + 评分理由 |

#### AutoEarn

| ID | 用户故事 | 验收标准 |
|----|---------|---------|
| US-07 | 我希望把闲置资产放入自动理财赚收益 | 一键存入 → 选择风险等级 → 自动分配策略 |
| US-08 | 我希望随时查看我的理财收益 | 收益曲线图 + 今日/累计收益 |
| US-09 | 我希望随时可以取出我的资产 | 一键提取本金+收益 |

#### Personal Agent

| ID | 用户故事 | 验收标准 |
|----|---------|---------|
| US-10 | 我希望用自然语言与我的 Agent 对话 | 聊天界面，支持文字输入 |
| US-11 | 我希望 Agent 帮我执行简单理财指令 | "帮我领取所有空投" → 执行 → 反馈 |

---

### 3.2 商户身份故事（P0 - MVP）

| ID | 用户故事 | 验收标准 |
|----|---------|---------|
| US-12 | 我希望查看我的分佣计划列表 | 列表展示名称/类型/状态/费率 |
| US-13 | 我希望快速生成收款链接 | 选择分佣计划 → 输入金额 → 生成链接/二维码 |
| US-14 | 我希望查看结算流水与状态 | 结算列表按时间倒序，支持状态筛选 |
| US-15 | 我希望预览一笔交易的分佣分配 | 输入金额 → 显示费用明细与净额 |

---

### 3.3 开发者身份故事（P0 - MVP）

| ID | 用户故事 | 验收标准 |
|----|---------|---------|
| US-16 | 我希望查看我参与的预算池 | 预算池列表：名称/总预算/已注资/状态 |
| US-17 | 我希望查看和管理里程碑 | 里程碑列表：状态/金额/截止时间 |
| US-18 | 我希望在任务市场查看可接订单 | 订单列表按匹配度排序 |
| US-19 | 我希望查看我的收益中心 | 待结算/可提现/已提现 |

---

### 3.4 Phase 2 用户故事

| ID | 身份 | 用户故事 |
|----|-----|---------|
| US-20 | 个人 | 我希望批量领取多个空投（Gas 优化） |
| US-21 | 个人 | 我希望配置 DCA 定投策略 |
| US-22 | 商户 | 我希望查看分佣计划详情并编辑 |
| US-23 | 商户 | 我希望查看收入数据分析 |
| US-24 | 开发者 | 我希望发布我的 Skill 到市场 |
| US-25 | 开发者 | 我希望提交里程碑交付物 |

---

### 3.5 Phase 3 用户故事

| ID | 身份 | 用户故事 |
|----|-----|---------|
| US-26 | 个人 | 我希望使用网格交易/套利策略 |
| US-27 | 个人 | 我希望跟单（Copy Trading）高手策略 |
| US-28 | 商户 | 我希望导出结算报表 |
| US-29 | 开发者 | 我希望在任务市场主动投标 |

---

## 4. 功能需求

### 4.0 Layer 0: 资产管理层（MVP 核心）

#### 4.0.1 资产总览

**定位**：首页核心模块，让用户一眼看到全部资产。

| 功能点 | 描述 | MVP | Phase |
|-------|-----|-----|-------|
| 总资产卡片 | 聚合所有链的资产总值（USD 计价） | ✅ | P1 |
| 24h 涨跌幅 | 资产变化百分比和金额 | ✅ | P1 |
| 多链余额 | 按链分组展示（ETH/BSC/Polygon/Arbitrum/Base/Solana） | ✅ | P1 |
| 代币列表 | 展示持有的代币及价值 | ✅ | P1 |
| 资产分析 | 持仓分布饼图、收益曲线 | ❌ | P2 |

#### 4.0.2 交易流水

| 功能点 | 描述 | MVP | Phase |
|-------|-----|-----|-------|
| 交易列表 | 按时间倒序，显示类型/金额/状态 | ✅ | P1 |
| 类型筛选 | 收入/支出/空投/AutoEarn | ✅ | P1 |
| 交易详情 | 链上 TxHash、时间戳、Gas 费用 | ❌ | P2 |

#### 4.0.3 钱包连接

| 功能点 | 描述 | MVP | Phase |
|-------|-----|-----|-------|
| WalletConnect | 支持主流钱包（MetaMask/Rainbow/Trust） | ✅ | P1 |
| 多钱包管理 | 添加/切换/删除钱包 | ✅ | P1 |
| 链切换 | 手动切换当前活跃链 | ✅ | P1 |

---

### 4.1 Layer 1: 空投系统（Airdrop - MVP 核心）

#### 4.1.1 空投发现

**定位**：自动扫描全网空投机会，让用户不错过任何收益。

| 功能点 | 描述 | MVP | Phase |
|-------|-----|-----|-------|
| 空投列表 | 展示可领取的空投（名称/价值/截止时间） | ✅ | P1 |
| 资格检查 | 自动检查用户钱包是否有资格 | ✅ | P1 |
| 风险评分 | 安全/中等/高风险 + 评分理由 | ✅ | P1 |
| 多链支持 | ETH/BSC/Polygon/Arbitrum/Base/Solana | ✅ | P1 |
| 价值估算 | 预估空投代币价值（USD） | ✅ | P1 |
| 截止提醒 | 即将过期的空投优先展示 | ❌ | P2 |

#### 4.1.2 空投领取

| 功能点 | 描述 | MVP | Phase |
|-------|-----|-----|-------|
| 一键领取 | 点击 → 确认 → 链上交易 → 到账 | ✅ | P1 |
| Gas 预估 | 显示预估 Gas 费用 | ✅ | P1 |
| 交易状态 | Pending → Confirmed → Success/Failed | ✅ | P1 |
| 批量领取 | 一次领取多个空投（Gas 优化） | ❌ | P2 |
| 最佳时机 | 监控 Gas 价格，建议最佳领取时间 | ❌ | P2 |

#### 4.1.3 空投数据源

| 数据源 | 描述 | MVP | Phase |
|-------|-----|-----|-------|
| DeBank API | 钱包资产和空投数据 | ✅ | P1 |
| Earndrop | 免费空投聚合 | ✅ | P1 |
| 链上爬虫 | Merkle Distributor 合约扫描 | ❌ | P3 |

---

### 4.2 Layer 2: AutoEarn 自动收益（MVP 核心）

#### 4.2.1 一键理财

**定位**：像余额宝一样简单，存入即赚收益。

| 功能点 | 描述 | MVP | Phase |
|-------|-----|-----|-------|
| 存入资产 | 选择代币 → 输入金额 → 确认存入 | ✅ | P1 |
| 风险选择 | 低风险/中风险/高风险 | ✅ | P1 |
| 预估收益 | 显示预估 APY 和收益 | ✅ | P1 |
| 自动分配 | 根据风险偏好自动选择最优策略 | ✅ | P1 |
| 随时提取 | 一键提取本金+收益 | ✅ | P1 |

#### 4.2.2 收益中心

| 功能点 | 描述 | MVP | Phase |
|-------|-----|-----|-------|
| 收益曲线 | 7 天/30 天/全部收益趋势图 | ✅ | P1 |
| 今日收益 | 实时更新今日收益 | ✅ | P1 |
| 累计收益 | 总收益金额 | ✅ | P1 |
| 策略明细 | 展示资金分配到哪些策略 | ❌ | P2 |

#### 4.2.3 高级策略（Phase 2+）

| 策略类型 | 描述 | Phase |
|---------|-----|-------|
| DCA 定投 | 定时定额购买目标代币 | P2 |
| 网格交易 | 设置价格区间自动低买高卖 | P2 |
| 套利机器人 | 跨 DEX 价格差套利 | P3 |
| Copy Trading | 跟随高手策略自动交易 | P3 |

---

### 4.3 Layer 3: 个人 Agent（MVP 核心）

#### 4.3.1 Agent 对话

**定位**：你的 24/7 AI 财富助手。

| 功能点 | 描述 | MVP | Phase |
|-------|-----|-----|-------|
| 聊天界面 | 类似 ChatGPT 的对话体验 | ✅ | P1 |
| 文字输入 | 自然语言交互 | ✅ | P1 |
| 语音输入 | 语音转文字 | ❌ | P2 |
| 上下文记忆 | Agent 记住历史对话 | ✅ | P1 |

#### 4.3.2 Agent 能力

| 能力 | 描述 | MVP | Phase |
|-----|-----|-----|-------|
| 资产查询 | "我有多少 ETH？" | ✅ | P1 |
| 空投助手 | "帮我领取所有空投" | ✅ | P1 |
| 理财建议 | "我应该怎么配置资产？" | ✅ | P1 |
| 策略执行 | "帮我设置每周定投 100U" | ❌ | P2 |
| 市场分析 | "ETH 最近走势怎么样？" | ❌ | P2 |

#### 4.3.3 Agent 设置

| 功能点 | 描述 | MVP | Phase |
|-------|-----|-----|-------|
| 风险偏好 | 保守/稳健/激进 | ✅ | P1 |
| 自动领取 | 开启后自动领取安全空投 | ❌ | P2 |
| 执行授权 | 授权 Agent 自动执行策略 | ❌ | P2 |
| 通知偏好 | 设置推送频率和类型 | ❌ | P2 |

---

### 4.4 Layer 2: 商户功能层（MVP 核心）

#### 4.4.1 分佣计划管理

**定位**：商户核心功能，管理收益分配规则。

| 功能点 | 描述 | MVP | Phase |
|-------|-----|-----|-------|
| 计划列表 | 展示名称/类型/状态/费率 | ✅ | P1 |
| 计划详情 | 规则配置、创建时间、关联订单 | ❌ | P2 |
| 分佣预览 | 输入金额 → 显示分配明细 | ✅ | P1 |
| 创建计划 | 保留在 Web 端操作 | ❌ | - |

#### 4.4.2 收款工具

| 功能点 | 描述 | MVP | Phase |
|-------|-----|-----|-------|
| 收款链接生成 | 选择计划 → 输入金额 → 生成链接 | ✅ | P1 |
| 二维码生成 | 支持微信/支付宝扫码 | ✅ | P1 |
| 链接分享 | 一键分享到社交平台 | ✅ | P1 |
| 收款状态 | 实时查看收款进度 | ❌ | P2 |

#### 4.4.3 结算账本

| 功能点 | 描述 | MVP | Phase |
|-------|-----|-----|-------|
| 结算列表 | 订单/金额/状态/时间 | ✅ | P1 |
| 状态筛选 | 待结算/处理中/已完成 | ✅ | P1 |
| 结算详情 | 交易 Hash/时间线 | ❌ | P2 |
| 报表导出 | 导出 Excel/PDF | ❌ | P3 |

---

### 4.5 Layer 3: 开发者功能层（MVP 核心）

#### 4.5.1 预算池管理

**定位**：开发者查看和管理参与的项目。

| 功能点 | 描述 | MVP | Phase |
|-------|-----|-----|-------|
| 预算池列表 | 名称/总预算/已注资/状态 | ✅ | P1 |
| 预算池详情 | 里程碑列表/参与方 | ❌ | P2 |
| 资金状态 | 已释放/待释放/锁定 | ✅ | P1 |

#### 4.5.2 里程碑管理

| 功能点 | 描述 | MVP | Phase |
|-------|-----|-----|-------|
| 里程碑列表 | 名称/状态/金额/截止时间 | ✅ | P1 |
| 状态查看 | 待提交/待审批/已释放 | ✅ | P1 |
| 提交交付 | 上传交付物/标记完成 | ❌ | P2 |
| 审批流程 | 查看审批进度 | ❌ | P2 |

#### 4.5.3 接单中心

| 功能点 | 描述 | MVP | Phase |
|-------|-----|-----|-------|
| 订单列表 | 可接订单/进行中/已完成 | ✅ | P1 |
| 订单详情 | 需求描述/预算/截止时间 | ✅ | P1 |
| 一键接单 | 确认接单 | ❌ | P2 |
| 主动投标 | 任务市场投标 | ❌ | P3 |

#### 4.5.4 收益中心

| 功能点 | 描述 | MVP | Phase |
|-------|-----|-----|-------|
| 收益总览 | 待结算/可提现/已提现 | ✅ | P1 |
| 收益明细 | 按订单/里程碑分组 | ✅ | P1 |
| 提现操作 | 发起提现请求 | ❌ | P2 |

---

### 4.6 Layer 4: 平台服务层

#### 4.6.1 身份管理与审核

| 功能点 | 描述 | MVP | Phase |
|-------|-----|-----|-------|
| 身份切换 | 个人/商户/开发者 Tab 切换 | ✅ | P1 |
| 商户申请 | 提交商户资质申请 | ✅ | P1 |
| 开发者申请 | 提交开发者资质申请 | ✅ | P1 |
| 审核状态 | 查看审核进度（与 Web 同步） | ✅ | P1 |
| 身份同步 | Web 端激活的身份自动在 App 生效 | ✅ | P1 |

#### 4.6.2 设置中心

| 设置项 | MVP | Phase |
|-------|-----|-------|
| 钱包管理 | ✅ | P1 |
| Token/授权管理 | ✅ | P1 |
| 环境切换（Sandbox/Production） | ✅ | P1 |
| 通知偏好 | ❌ | P2 |
| 语言切换 | ❌ | P3 |

#### 4.6.3 安全与认证

| 安全措施 | 描述 |
|---------|-----|
| OAuth 2.0 | 复用 Web 端登录（Google/Twitter/Wallet） |
| Biometric | 支持 Face ID / 指纹解锁 |
| 会话管理 | Token 刷新 + 异常登录提醒 |
| 敏感操作 | 二次确认（如大额结算、环境切换） |

#### 4.6.4 推送通知（Phase 2）

| 通知类型 | 触发条件 |
|---------|---------|
| 空投发现 | 发现新空投机会 |
| 收益到账 | AutoEarn 收益/结算到账 |
| 收款成功 | 商户收款完成 |
| 里程碑变更 | 开发者里程碑状态更新 |
| 审核结果 | 身份审核通过/拒绝 |

---

## 5. API 对接

### 5.1 接口清单

| 模块 | 接口 | 方法 | MVP |
|-----|-----|-----|-----|
| 分佣计划 | `/commerce/split-plans` | GET | ✅ |
| 分佣预览 | `/commerce/split-plans/preview` | POST | ✅ |
| 预算池 | `/commerce/budget-pools` | GET | ✅ |
| 预算池详情 | `/commerce/budget-pools/:id` | GET | P2 |
| 结算列表 | `/commerce/settlements` | GET | ✅ |
| 结算详情 | `/commerce/settlements/:id` | GET | P2 |
| 资金账户 | `/accounts/balance` | GET | ✅ |
| Agent Profile | `/agents/me` | GET | ✅ |
| Agent 收益 | `/agents/me/earnings` | GET | ✅ |

### 5.2 数据模型

```typescript
// 复用 backend commerce DTO
interface SplitPlan {
  id: string;
  name: string;
  type: 'standard' | 'tiered' | 'custom';
  status: 'active' | 'paused' | 'archived';
  commissionRate: number;
  createdAt: string;
}

interface BudgetPool {
  id: string;
  name: string;
  totalBudget: number;
  fundedAmount: number;
  status: 'draft' | 'active' | 'completed';
  milestonesCount: number;
}

interface Settlement {
  id: string;
  type: 'order' | 'milestone';
  amount: number;
  currency: string;
  status: 'pending' | 'processing' | 'completed' | 'failed';
  createdAt: string;
}

interface AccountBalance {
  fiat: { currency: string; available: number; pending: number; frozen: number };
  crypto: { chain: string; token: string; available: number; pending: number }[];
}

interface AgentProfile {
  id: string;
  name: string;
  avatar: string;
  rating: number;
  skills: string[];
  totalEarnings: number;
  tasksCompleted: number;
  completionRate: number;
}
```

### 5.3 离线与缓存策略

| 数据类型 | 缓存策略 | 过期时间 | 说明 |
|---------|---------|---------|-----|
| 分佣计划列表 | Cache-first | 5 分钟 | 变化频率低 |
| 预算池列表 | Cache-first | 5 分钟 | 变化频率低 |
| 账户余额 | Network-first | 不缓存 | 实时性要求高 |
| Agent Profile | Cache-first | 10 分钟 | 变化频率低 |
| 结算列表 | Network-first | 1 分钟 | 需要及时更新 |

---

## 6. 交互与 UX

### 6.1 设计原则

| 原则 | 实现 |
|-----|-----|
| **一致性** | 深色主题，与 Agentrix Web 统一色板 |
| **可读性** | 数据卡片化，关键数字放大突出 |
| **即时反馈** | 操作后 <300ms 反馈（加载/成功/失败） |
| **容错性** | 网络异常提示 + 重试按钮 |

### 6.2 首页线框图（统一首页 + 身份切换）

**统一首页架构**：所有用户看到同一个首页框架，通过顶部身份切换器切换内容。

```
┌────────────────────────────────────┐
│ ≡  Agentrix              🔔   👤  │ ← 顶栏
├────────────────────────────────────┤
│ ┌──────┐ ┌──────┐ ┌──────────┐   │
│ │ 个人 │ │ 商户 │ │ 开发者🔒 │   │ ← 身份切换 Tab
│ │(活跃)│ │(活跃)│ │ (未激活) │   │   🔒表示需要申请激活
│ └──────┘ └──────┘ └──────────┘   │
├────────────────────────────────────┤
│                                    │
│     （根据身份显示不同内容）         │
│                                    │
└────────────────────────────────────┘
│   🏠      💰      📊      👤     │ ← Tab Bar
│  首页    资产    活动    我的     │
└────────────────────────────────────┘
```

**个人身份首页**：
```
┌────────────────────────────────────┐
│  个人  │ 商户 │ 开发者🔒          │ ← 身份 Tab
├────────────────────────────────────┤
│ ┌────────────────────────────────┐│
│ │ 💰 总资产：$12,345            ││
│ │ +$234 (1.9%) 今日            ││ ← 资产卡片
│ │ ┌───────┐ ┌───────┐ ┌──────┐ ││
│ │ │ USDT  │ │ ETH   │ │ SOL  │ ││
│ │ │ 8,000 │ │ 3,200 │ │ 1,145│ ││
│ │ └───────┘ └───────┘ └──────┘ ││
│ └────────────────────────────────┘│
├────────────────────────────────────┤
│ 🎁 发现空投（3 个可领）           │
│ ┌─────────────┐ ┌─────────────┐  │
│ │ Jupiter     │ │ LayerZero   │  │ ← 空投卡片
│ │ 预估 $120   │ │ 预估 $80    │  │
│ │ 【一键领取】│ │ 【一键领取】│  │
│ └─────────────┘ └─────────────┘  │
├────────────────────────────────────┤
│ ⚡ AutoEarn 收益                   │
│ 今日 +$12.5 | 累计 +$456         │ ← AutoEarn 入口
│ 【管理策略】                       │
├────────────────────────────────────┤
│ 🤖 我的 Agent（快速入口）          │
│ → 对话 Agent | 任务历史 | 设置   │
└────────────────────────────────────┘
```

**商户身份首页**（需激活）：
```
┌────────────────────────────────────┐
│  个人 │  商户  │ 开发者            │ ← 身份 Tab
├────────────────────────────────────┤
│ ┌────────────────────────────────┐│
│ │ 📈 今日收款：¥5,678           ││
│ │ 待结算 ¥12,000 | 可提现 ¥8,500││ ← 收款概览
│ └────────────────────────────────┘│
├────────────────────────────────────┤
│ 💳 快速收款                        │
│ ┌────────────────────────────────┐│
│ │ 输入金额：¥ [________]         ││
│ │ 分佣计划：[标准 10% ▼]        ││ ← 快速收款
│ │         【生成收款码】         ││
│ └────────────────────────────────┘│
├────────────────────────────────────┤
│ 📋 最近订单                        │
│ • ¥1,500 - 已完成 - 5分钟前      │
│ • ¥800 - 处理中 - 1小时前        │ ← 订单流水
│ • ¥2,300 - 已完成 - 今天         │
├────────────────────────────────────┤
│ 📊 分佣计划（3 个）               │
│ 【管理计划】                       │
└────────────────────────────────────┘
```

**开发者身份首页**（需激活）：
```
┌────────────────────────────────────┐
│  个人 │ 商户 │  开发者             │ ← 身份 Tab
├────────────────────────────────────┤
│ ┌────────────────────────────────┐│
│ │ 💰 开发者收益                  ││
│ │ 待结算 $2,500 | 可提现 $1,800 ││ ← 收益概览
│ │ 本周 +$800                     ││
│ └────────────────────────────────┘│
├────────────────────────────────────┤
│ ⚡ 待处理任务                       │
│ • 里程碑 "API对接" 待提交 (明天)  │
│ • 里程碑 "UI设计" 审批中         │ ← 待办事项
│ • 新订单 "小程序开发" 待接单     │
├────────────────────────────────────┤
│ 📦 我的预算池（2 个活跃）          │
│ • Agentrix SDK 开发 - $5,000     │
│ • 商城小程序 - $3,000            │ ← 预算池列表
├────────────────────────────────────┤
│ 🎯 任务市场（8 个匹配）            │
│ 【浏览市场】                       │
└────────────────────────────────────┘
```

**未激活身份页面**：
```
┌────────────────────────────────────┐
│  个人 │ 商户 │  开发者🔒          │ ← 身份 Tab
├────────────────────────────────────┤
│                                    │
│        🔒 开发者身份未激活        │
│                                    │
│   激活开发者身份，解锁：           │
│   ✓ 接单赚钱                      │
│   ✓ 管理预算池和里程碑            │
│   ✓ 发布 Skill 到市场             │
│                                    │
│   ┌───────────────────────┐       │
│   │     【申请激活】       │       │
│   └───────────────────────┘       │
│                                    │
│   已在 Web 端申请？App 自动同步    │
│                                    │
└────────────────────────────────────┘
```

### 6.3 手势与动效

| 交互 | 效果 |
|-----|-----|
| 下拉刷新 | 列表页全局刷新 |
| 左滑 | 结算项快捷操作（查看详情） |
| 长按 | 复制结算 ID / 交易 Hash |
| 金额动效 | 数字滚动增长动画 |

---

## 7. 技术方案

### 7.1 技术栈选型

| 类别 | 选型 | 理由 |
|-----|-----|-----|
| 框架 | React Native + Expo (SDK 52) | 跨平台、OTA 热更新、生态成熟 |
| 语言 | TypeScript 5.x | 类型安全，与后端/Web 对齐 |
| 导航 | Expo Router (基于 React Navigation) | 文件系统路由，支持深链接 |
| 状态管理 | Zustand + TanStack Query v5 | 轻量客户端状态 + 服务端状态管理 |
| 样式 | NativeWind v4 (Tailwind CSS) | 与 Web 端样式一致 |
| 图表 | Victory Native XL | 轻量高性能图表库 |
| 本地存储 | MMKV | 高性能 key-value 存储 |
| 安全存储 | expo-secure-store | Token 加密存储 |

### 7.2 项目结构

```
mobile-app/
├── app/                       # Expo Router 页面
│   ├── (tabs)/               # Tab 导航
│   │   ├── index.tsx         # 首页
│   │   ├── plans.tsx         # 分佣计划
│   │   ├── pools.tsx         # 预算池
│   │   ├── settlements.tsx   # 结算
│   │   └── profile.tsx       # Agent Profile
│   ├── plan/[id].tsx         # 计划详情
│   ├── pool/[id].tsx         # 预算池详情
│   ├── preview.tsx           # 分佣预览
│   └── settings.tsx          # 设置
├── components/               # 可复用组件
│   ├── cards/
│   │   ├── BalanceCard.tsx
│   │   └── AgentCard.tsx
│   ├── lists/
│   │   ├── PlanListItem.tsx
│   │   └── SettlementListItem.tsx
│   └── common/
│       ├── LoadingSpinner.tsx
│       └── ErrorBoundary.tsx
├── services/                 # API 封装
│   ├── api.ts                # Axios 实例
│   ├── commerce.api.ts
│   └── agent.api.ts
├── stores/                   # Zustand stores
│   ├── authStore.ts
│   └── settingsStore.ts
├── hooks/                    # TanStack Query hooks
│   ├── useSplitPlans.ts
│   ├── useBudgetPools.ts
│   └── useSettlements.ts
├── theme/                    # 主题配置
│   ├── colors.ts
│   └── typography.ts
├── utils/                    # 工具函数
│   ├── formatters.ts
│   └── validators.ts
└── types/                    # TypeScript 类型
    └── commerce.types.ts
```

### 7.3 性能目标

| 指标 | 目标 | 测量工具 |
|-----|-----|---------|
| 冷启动时间 | < 2s | Flipper |
| 列表滚动 FPS | ≥ 55 | Perf Monitor |
| API 响应感知 | < 300ms | Network + Cache |
| 内存占用 | < 150MB | Xcode/Android Profiler |
| 包体积 | < 50MB | EAS Build |

### 7.4 安全架构

```
┌─────────────────────────────────────────┐
│              Mobile App                 │
├─────────────────────────────────────────┤
│  Secure Storage Layer                   │
│  - expo-secure-store (Keychain/Keystore)│
│  - Access Token (encrypted)             │
│  - Refresh Token (encrypted)            │
├─────────────────────────────────────────┤
│  Biometric Auth Layer                   │
│  - expo-local-authentication            │
│  - Face ID / Touch ID / Fingerprint     │
├─────────────────────────────────────────┤
│  Network Security Layer                 │
│  - HTTPS Only                           │
│  - Certificate Pinning (可选)            │
│  - Request Signing (敏感操作)            │
└─────────────────────────────────────────┘
```

---

## 8. 里程碑与计划

### 开发资源假设
- 1 名移动端开发（全职）
- 0.5 名后端支持（接口对接，复用 Web 后端）
- 0.5 名设计支持（UI 走查）

### Phase 1 - MVP（3 周）

**目标**：三身份核心功能可用，统一首页 + 身份切换完成

| 周次 | 身份 | 任务 | 交付物 |
|-----|-----|-----|--------|
| **W1** | 基础 | 项目搭建 + OAuth 登录 + 统一首页框架 + 身份切换 UI | 可运行 App，身份切换 |
| | 个人 | 资产总览卡片 + 钱包连接 | 个人首页基础 |
| **W2** | 个人 | 空投发现 + 一键领取 + AutoEarn 入口 | 个人核心流程 |
| | 商户 | 分佣计划列表 + 快速收款（生成链接/二维码） | 商户核心流程 |
| **W3** | 商户 | 结算账本列表 | 商户完整 |
| | 开发者 | 预算池列表 + 里程碑列表 + 收益总览 | 开发者核心流程 |
| | 通用 | 身份申请激活流程 + Web 同步 | MVP 完整版 |

**MVP 核心功能清单**：

| 身份 | MVP 功能 |
|-----|---------|
| 个人 | ✅ 资产总览、✅ 钱包连接、✅ 空投发现、✅ 一键领取、✅ AutoEarn 入口 |
| 商户 | ✅ 分佣计划列表、✅ 分佣预览、✅ 快速收款、✅ 结算账本列表 |
| 开发者 | ✅ 预算池列表、✅ 里程碑列表、✅ 收益总览、✅ 接单列表 |
| 通用 | ✅ 身份切换、✅ 身份激活申请、✅ OAuth 登录、✅ 环境切换 |

### Phase 2 - 增强（3 周）

**目标**：生产可用版本 + 个人 Agent 功能

| 周次 | 任务 |
|-----|-----|
| W4 | 个人 Agent 对话 + 任务创建 + 历史记录 |
| W5 | AutoEarn 策略管理 + 收益分析 + 通知推送 |
| W6 | 商户结算详情 + 开发者里程碑提交 + 审批流程 |

### Phase 3 - 扩展（4 周）

**目标**：增长引擎 + 完整功能

| 周次 | 任务 |
|-----|-----|
| W7-8 | 任务市场（开发者接单） + 社交分享（商户收款链接/Agent 名片）|
| W9-10 | 钱包连接（WalletConnect）+ 多语言 + 报表导出 + 分佣计划管理 |

---

## 9. 风险与应对

| 风险 | 影响 | 概率 | 应对措施 |
|-----|-----|-----|---------|
| 后端 API 不兼容移动端需求 | 🔴 高 | 中 | 提前定义接口契约，使用 Mock Server |
| 结算数据无持久化（内存存储） | 🔴 高 | 高 | **优先推动后端补全 DB 存储** |
| App Store / Google Play 审核被拒 | 🟡 中 | 中 | 提前准备合规说明、隐私政策 |
| 钱包签名流程复杂 | 🟡 中 | 低 | Phase 3 处理，先用后端 Relayer |
| 列表性能问题 | 🟡 中 | 低 | 使用 FlashList + React Query 分页 |

---

## 10. 关键指标（KPIs）

### 10.1 核心指标（三身份维度）

| 指标 | MVP 目标 (1个月) | 3 个月目标 |
|-----|-----------------|-----------|
| **总用户 DAU** | 2,000 | 10,000 |
| **个人身份活跃** | 2,000 | 10,000 |
| **商户身份激活** | 200 | 1,500 |
| **开发者身份激活** | 100 | 800 |
| **AUM（用户资产管理规模）** | $100 万 | $500 万 |
| 空投领取转化率 | 30% | 50% |
| AutoEarn 使用率 | 20% | 40% |

### 10.2 身份激活漏斗

| 阶段 | MVP 目标 |
|-----|---------|
| 注册用户 | 5,000 |
| 个人身份活跃 | 2,000 (40%) |
| 申请商户 | 500 (10%) |
| 商户激活 | 200 (4%) |
| 申请开发者 | 300 (6%) |
| 开发者激活 | 100 (2%) |

### 10.3 北极星指标

**AUM（用户资产管理规模）**：目标 3 个月后达到 **$500 万**

**次级指标**：
- 商户月收款额：$50 万
- 开发者月结算额：$30 万

---

## 11. 附录

### 11.1 费用规则

| 支付类型 | 基础费率 | 分账费用 | 最低费用 |
|---------|---------|---------|---------|
| 纯 Crypto | 0% | 0.3% | 0.1 USDC |
| Onramp | +0.1% | 0.3% | 0.1 USDC |
| Offramp | +0.1% | 0.3% | 0.1 USDC |
| Mixed | 0.1% | 0.3% | 0.1 USDC |

### 11.2 支付类型枚举

```typescript
type PaymentType = 'crypto_direct' | 'onramp' | 'offramp' | 'mixed';
```

### 11.3 环境配置

| 环境 | API Base URL | 用途 |
|-----|-------------|-----|
| Sandbox | `https://sandbox-api.agentrix.io` | 开发测试 |
| Production | `https://api.agentrix.io` | 生产环境 |

### 11.4 隐私与合规

- 遵循 GDPR / CCPA 数据保护要求
- 敏感数据（Token、钱包密钥）使用 Keychain/Keystore 加密存储
- 提供用户数据导出与删除功能（GDPR Article 17）
- App Store / Google Play 合规审核前置准备

---

## 12. 审批与签署

| 角色 | 姓名 | 日期 | 签署 |
|-----|-----|-----|-----|
| 产品负责人 | | | ☐ |
| 技术负责人 | | | ☐ |
| 设计负责人 | | | ☐ |
