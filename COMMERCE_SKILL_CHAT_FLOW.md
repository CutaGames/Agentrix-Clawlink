# Agentrix Commerce Skill 对话框使用流程（设计稿）

本文档沉淀本次讨论的**技能调用入口**与**完整交互流程**，用于指导后续在 Agentrix 工作台对话框、Cursor/IDE 与 Claude Desktop 的一致体验实现。

---

## 一、技能入口与识别（统一设计）

### 1) 自然语言触发（默认入口）
- 用户直接描述需求，例如：
  - “我要创建分账方案”
  - “给团队建一个预算池”
  - “帮我算手续费”

系统行为：
- 语义识别 → 归类到 commerce skill 下的分类 → 展示分类卡片

### 2) @技能直呼（强入口）
- 用户输入：`@commerce` 或 `@agentrix commerce`
- 直接进入 commerce 技能的分类卡片

### 3) 命令式入口
- 用户输入：`/skills` → 展示**可用技能列表**
- 用户输入：`/commerce` 或 `/skill commerce` → 进入 commerce 分类卡片

### 4) UI 按钮入口
- “Skills”按钮 → 列表 + 搜索
- 选择 `commerce` → 展示分类卡片

---

## 二、commerce skill 分类卡片（默认展示）

进入 `commerce` 后展示 8 个主要类别：
1. 支付/收款
2. 法币/数字货币兑换（On‑ramp / Off‑ramp）
3. 分账/分佣
4. 预算池
5. 里程碑
6. 协作酬劳
7. 费用计算
8. 费率结构

每个类别点击后进入**表单化输入**，避免用户理解参数。

---

## 三、按类别的完整对话流程

### A. 支付 / 收款
**触发语句**：
- “我要付款/收款”
- “生成支付链接”

**交互步骤**：
1. 表单（金额、币种、收款方、订单描述）
2. 返回支付链接或订单状态

---

### B. 法币/数字货币兑换（On‑ramp / Off‑ramp）
**触发语句**：
- “用法币换USDC”
- “把USDC提现吗”

**交互步骤**：
1. 表单（金额、法币/加密币种、目标地址或到账方式）
2. 返回兑换/提现链接或状态

### C. 分账 / 分佣（Split Plan）
**触发语句**：
- “设置分佣比例”
- “创建分账方案”

**交互步骤**：
1. 展示分账表单（参与方 + 比例）
2. 用户填写并确认
3. 返回结果卡片：`splitPlanId` + 分配明细

**下一步按钮**：
- 激活方案 / 关联商品 / 预览分账

---

### D. 预算池（Budget Pool）
**触发语句**：
- “给团队分配预算”
- “建一个任务预算池”

**交互步骤**：
1. 展示预算池表单（总预算、截止时间、质量门槛）
2. 用户确认
3. 返回结果卡片：`poolId` + 预算摘要

**下一步按钮**：
- 添加里程碑 / 立即激活

---

### E. 里程碑（Milestone）
**触发语句**：
- “给预算池加一个里程碑”
- “提交里程碑验收”

**交互步骤**：
1. 表单（里程碑标题、比例、要求）
2. 返回 `milestoneId`
3. 如是验收：展示验收结果 + 释放资金提示

---

### F. 协作酬劳
**触发语句**：
- “给协作团队发放报酬”
- “按里程碑放款”

**交互步骤**：
1. 选择预算池或新建预算池
2. 选择里程碑或填写发放条件
3. 返回发放记录与状态

---

### G. 费用计算 / 预览
**触发语句**：
- “算手续费”
- “预览分账结果”

**交互步骤**：
1. 表单（金额、支付方式）
2. 返回费用明细、净收入

---

### H. 费率结构
**触发语句**：
- “费率结构是什么？”

**交互步骤**：
1. 直接返回平台费率结构卡片

---

## 四、统一结果展示规范

- 结果卡片必须包含：
  - ID（如 splitPlanId / poolId / milestoneId）
  - 关键字段摘要
  - 状态（成功/失败）

- 提供“下一步建议按钮”
  - 如：创建里程碑 / 激活预算池 / 继续分账

- 提供“查看详情”链接
  - 跳转对应管理页面

---

## 五、技能列表展示规范

### `/skills` 或 Skills 按钮
- 展示可用技能列表 + 搜索框
- 分组展示（支付类 / 商务类 / 工具类）

### `@commerce`
- 直接展示 commerce 分类卡片（不显示参数）

---

## 六、任务/商品/Skill 发布入口（新增）

**目标**：基于 commerce 能力，将**任务、商品或 Skill**一键发布到 Agentrix Marketplace 或外部平台。

### 触发方式
- 自然语言：
  - “发布一个协作任务到 marketplace”
  - “发布商品到 marketplace”
  - “发布 skill 到 marketplace”
  - “同步到外部任务平台”
- 入口按钮：
  - “发布任务”

### 表单字段（建议）
- 任务标题、描述、预算、截止时间、交付要求
- 商品/Skill 信息（名称、描述、价格、交付方式、标签）
- 支付/分佣策略：
  - 选择分账方案或自动生成
  - 里程碑拆分（可选）
- 发布渠道：
  - Agentrix Marketplace
  - 其他任务平台（可配置）

### 执行流
1. 选择发布类型（任务/商品/Skill）
2. 任务：创建预算池 + 里程碑（可选）
3. 商品/Skill：生成或选择分账方案
4. 发布到 Marketplace / 外部平台
5. 返回发布ID + 入口链接

### 可行性评估（结论）
- **可行**：现有 commerce 能力已覆盖预算池、里程碑、分账、费用计算。
- **缺口**：需要新增“任务发布”聚合服务（将任务元信息 + commerce 结构写入 marketplace / 外部平台）。
- **最小可行版本**：
  1) 仅发布到 Agentrix Marketplace；
  2) 外部平台先输出 Webhook/标准 JSON 供对接。

---

## 七、适配平台说明

**适配范围**：所有支持 Skill 的 Agent 与平台。

**协议支持**：
- **UCP**：用于商用能力发现与结账流程
- **X402**：用于自动化支付/授权

平台示例：
- **Agentrix 工作台**：
  - 目标是“表单化 + 卡片化”完整闭环

- **Cursor / IDE**：
  - MCP 工具列表入口 + 自然语言触发

- **Claude Desktop**：
  - MCP 工具栏入口 + `@commerce` 触发

---

## 八、下一步（确认后执行）

1. 在工作台对话框实现：
   - `@commerce` 分类卡片
   - `/skills` 列表
   - 表单化输入
   - 结果卡片
2. 增加“发布任务”入口与聚合流程
  - 预算池 + 里程碑 + 分账 + 发布

2. 输出统一测试用例 + 示例对话

---

> 本文档为流程设计稿，待确认后进入实现阶段。
