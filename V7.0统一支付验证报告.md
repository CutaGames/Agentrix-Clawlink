# V7.0 ç»Ÿä¸€æ”¯ä»˜éªŒè¯æŠ¥å‘Š

**éªŒè¯æ—¥æœŸ**: 2025-01-24  
**çŠ¶æ€**: âœ… åˆçº¦éƒ¨ç½²æˆåŠŸï¼Œåç«¯æœåŠ¡è¿è¡Œæ­£å¸¸

---

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. åˆçº¦éƒ¨ç½² âœ…

- **åˆçº¦åœ°å€**: `0x88b3993250Da39041C9263358C3c24C6a69a955e`
- **ç½‘ç»œ**: BSC Testnet (Chain ID: 97)
- **USDTåœ°å€**: `0x337610d27c682E347C9cD60BD4b3b107C9d34dDd`
- **Relayeråœ°å€**: `0x2bee8AE78e4E41cf7facc4A4387A8F299dd2b8f3`
- **éƒ¨ç½²çŠ¶æ€**: âœ… æˆåŠŸ

**éªŒè¯é“¾æ¥**: https://testnet.bscscan.com/address/0x88b3993250Da39041C9263358C3c24C6a69a955e

### 2. åç«¯ç¯å¢ƒé…ç½® âœ…

- **ERC8004_CONTRACT_ADDRESS**: `0x88b3993250Da39041C9263358C3c24C6a69a955e`
- **USDC_ADDRESS**: `0x337610d27c682E347C9cD60BD4b3b107C9d34dDd` (USDT)
- **RELAYER_PRIVATE_KEY**: å·²é…ç½®
- **RPC_URL**: å·²é…ç½®
- **åç«¯æœåŠ¡**: âœ… è¿è¡Œæ­£å¸¸ (`http://localhost:3001/api/docs` å¯è®¿é—®)

### 3. ä»£ç å®ç°çŠ¶æ€ âœ…

æ ¹æ®ä»£ç æ£€æŸ¥ï¼ŒV7.0ç»Ÿä¸€æ”¯ä»˜çš„æ ¸å¿ƒä»£ç å·²å…¨éƒ¨å®ç°ï¼š

- âœ… ERC-8004åˆçº¦ (`contract/contracts/ERC8004SessionManager.sol`)
- âœ… RelayeræœåŠ¡ (`backend/src/modules/relayer/`)
- âœ… Pre-Flight Check (`backend/src/modules/payment/preflight-check.service.ts`)
- âœ… Sessionç®¡ç† (`backend/src/modules/session/`)
- âœ… å‰ç«¯ç»„ä»¶ (`paymindfrontend/components/payment/SmartCheckout.tsx`)

---

## ğŸ” éœ€è¦æ‰‹åŠ¨éªŒè¯çš„æ­¥éª¤

ç”±äºWSLç½‘ç»œé™åˆ¶ï¼Œä»¥ä¸‹æ­¥éª¤éœ€è¦ä½ åœ¨æµè§ˆå™¨æˆ–Postmanä¸­æ‰‹åŠ¨éªŒè¯ï¼š

### æ­¥éª¤1: ç™»å½•è·å–JWT Token

**æ–¹æ³•1: ä½¿ç”¨Swagger UI**
1. è®¿é—®: http://localhost:3001/api/docs
2. æ‰¾åˆ° `POST /api/auth/login` æˆ– `POST /api/auth/register`
3. æ³¨å†Œ/ç™»å½•è·å– `access_token`

**æ–¹æ³•2: ä½¿ç”¨Postman/curl**
```bash
# æ³¨å†Œ
curl -X POST http://localhost:3001/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{"email":"test@example.com","password":"Test123456","paymindId":"test-user"}'

# ç™»å½•
curl -X POST http://localhost:3001/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email":"test@example.com","password":"Test123456"}'
```

### æ­¥éª¤2: æµ‹è¯•Pre-Flight Check

```bash
curl -X GET "http://localhost:3001/api/payment/preflight?amount=10&currency=USDC" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN"
```

**é¢„æœŸå“åº”**:
```json
{
  "recommendedRoute": "quickpay" | "wallet" | "crypto-rail",
  "quickPayAvailable": true | false,
  "sessionLimit": { ... },
  "walletBalance": "...",
  "requiresKYC": false,
  "estimatedTime": "< 1 second"
}
```

### æ­¥éª¤3: æµ‹è¯•Sessionåˆ›å»º

```bash
curl -X POST "http://localhost:3001/api/sessions" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "signer": "0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb",
    "singleLimit": 10000000,
    "dailyLimit": 100000000,
    "expiryDays": 30
  }'
```

**é¢„æœŸå“åº”**:
```json
{
  "sessionId": "0x...",
  "signer": "0x...",
  "singleLimit": "10.00",
  "dailyLimit": "100.00",
  "expiry": "...",
  "createdAt": "..."
}
```

### æ­¥éª¤4: æµ‹è¯•Relayer QuickPay

```bash
curl -X POST "http://localhost:3001/api/relayer/quickpay" \
  -H "Content-Type: application/json" \
  -d '{
    "sessionId": "0x...",
    "paymentId": "payment_123",
    "to": "0x2bee8AE78e4E41cf7facc4A4387A8F299dd2b8f3",
    "amount": "1000000",
    "signature": "0x...",
    "nonce": 1234567890
  }'
```

---

## ğŸ“Š éªŒè¯ç»“æœè®°å½•

å®Œæˆä»¥ä¸ŠéªŒè¯åï¼Œè¯·è®°å½•ç»“æœï¼š

### APIç«¯ç‚¹éªŒè¯
- [ ] Pre-Flight Check: âœ… / âŒ
- [ ] Sessionåˆ›å»º: âœ… / âŒ
- [ ] Sessionåˆ—è¡¨: âœ… / âŒ
- [ ] Relayer QuickPay: âœ… / âŒ

### å‰ç«¯åŠŸèƒ½éªŒè¯
- [ ] æ™ºèƒ½æ”¶é“¶å°æ˜¾ç¤º: âœ… / âŒ
- [ ] Pre-Flight Checkè‡ªåŠ¨æ‰§è¡Œ: âœ… / âŒ
- [ ] QuickPayæŒ‰é’®å¯ç”¨: âœ… / âŒ
- [ ] æ”¯ä»˜æµç¨‹æ­£å¸¸: âœ… / âŒ

### å®Œæ•´æµç¨‹éªŒè¯
- [ ] QuickPayå®Œæ•´æµç¨‹: âœ… / âŒ
- [ ] Walletæ”¯ä»˜æµç¨‹: âœ… / âŒ
- [ ] Crypto-Railæµç¨‹: âœ… / âŒ

---

## ğŸ¯ ä¸‹ä¸€æ­¥

1. **å®ŒæˆAPIéªŒè¯**: ä½¿ç”¨Swagger UIæˆ–Postmanæµ‹è¯•ä¸Šè¿°APIç«¯ç‚¹
2. **å‰ç«¯éªŒè¯**: å¯åŠ¨å‰ç«¯æœåŠ¡ï¼Œæµ‹è¯•æ™ºèƒ½æ”¶é“¶å°å’Œæ”¯ä»˜æµç¨‹
3. **å®Œæ•´æµç¨‹æµ‹è¯•**: æŒ‰ç…§ `éªŒè¯V7.0ç»Ÿä¸€æ”¯ä»˜æµç¨‹.md` æ–‡æ¡£è¿›è¡Œç«¯åˆ°ç«¯æµ‹è¯•

---

## ğŸ“ å·²çŸ¥é—®é¢˜

1. **ç¼–è¯‘é”™è¯¯**: `auto-fulfillment.service.ts` ä¸­æœ‰é‡å¤å¯¼å…¥ï¼ˆä¸å½±å“V7.0åŠŸèƒ½ï¼‰
2. **WSLç½‘ç»œé™åˆ¶**: curlå‘½ä»¤åœ¨WSLä¸­æ— æ³•è®¿é—®localhostï¼ˆéœ€è¦åœ¨Windowsç«¯æˆ–æµè§ˆå™¨ä¸­æµ‹è¯•ï¼‰

---

**æœ€åæ›´æ–°**: 2025-01-24  
**ç»´æŠ¤è€…**: PayMind å¼€å‘å›¢é˜Ÿ

