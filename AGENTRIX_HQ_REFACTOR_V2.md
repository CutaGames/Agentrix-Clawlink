# Agentrix HQ V2 Refactor: "Project Overwatch"

**Date:** 2026-01-28
**Status:** ACTIVE
**Author:** Agentrix Team
**Version:** 2.0

---

## ç›®å½• (Table of Contents)
1. [æ‰§è¡Œæ‘˜è¦](#1-æ‰§è¡Œæ‘˜è¦-executive-summary)
2. [ç«å“åˆ†æä¸å®šä½](#2-ç«å“åˆ†æä¸å®šä½)
3. [å½“å‰ç³»ç»Ÿè¯Šæ–­](#3-å½“å‰ç³»ç»Ÿè¯Šæ–­)
4. [ç›®æ ‡æ¶æ„è®¾è®¡](#4-ç›®æ ‡æ¶æ„è®¾è®¡)
5. [UI é‡æ„æ–¹æ¡ˆ](#5-ui-é‡æ„æ–¹æ¡ˆ)
6. [åç«¯é‡æ„æ–¹æ¡ˆ](#6-åç«¯é‡æ„æ–¹æ¡ˆ)
7. [Admin åŠŸèƒ½è¿ç§»æ¸…å•](#7-admin-åŠŸèƒ½è¿ç§»æ¸…å•)
8. [è¯¦ç»†å®æ–½è®¡åˆ’](#8-è¯¦ç»†å®æ–½è®¡åˆ’)
9. [é£é™©ä¸ç¼“è§£](#9-é£é™©ä¸ç¼“è§£)
10. [éªŒæ”¶æ ‡å‡†](#10-éªŒæ”¶æ ‡å‡†)

---

## 1. æ‰§è¡Œæ‘˜è¦ (Executive Summary)

### 1.1 é¡¹ç›®ç›®æ ‡
å°† "CEO Command Room HQ" ä»ä¸€ä¸ª**è¢«åŠ¨èŠå¤©ç•Œé¢**é‡æ„ä¸ºä¸€ä¸ª **24/7 å…¨è‡ªåŠ¨å•†ä¸šè¿è¥ç³»ç»Ÿ**ã€‚

### 1.2 æ ¸å¿ƒå“²å­¦
| æ¦‚å¿µ | å®šä½ | ç±»æ¯” |
|------|------|------|
| **HQ** | å…¬å¸å®ä½“ (Corporation) | æ‹¥æœ‰æ‰§ç…§ã€é“¶è¡Œè´¦æˆ·ã€èµ„äº§çš„æ³•äºº |
| **Claude/Agent** | å‘˜å·¥ (Employee) | æœ‰æ‰§è¡ŒåŠ›ä½†æ— äº§æƒçš„æ‰“å·¥äºº |
| **CEO (ç”¨æˆ·)** | è‘£äº‹é•¿ (Chairman) | åˆ¶å®šæ”¿ç­–ã€å®¡æ‰¹é¢„ç®—ã€éšæ—¶ä»‹å…¥ |

### 1.3 é¢„æœŸæˆæœ
- **ç¡åæ”¶å…¥ (Passive Income)**: Agent 24 å°æ—¶è‡ªåŠ¨æ‹“å®¢ã€æˆäº¤ã€æ”¶æ¬¾ã€‚
- **ä¸€äººå…¬å¸**: 1 åäººç±» CEO æŒ‡æŒ¥ N ä¸ª AI Agent å®Œæˆå…¨ä¸šåŠ¡æµã€‚
- **é£é™©å¯æ§**: æ‰€æœ‰è‡ªåŠ¨æ“ä½œéƒ½æœ‰é¢„ç®—ä¸Šé™å’Œäººå·¥å®¡æ‰¹å…œåº•ã€‚

---

## 2. ç«å“åˆ†æä¸å®šä½

### 2.1 ç«å“è¯†åˆ«
| ç«å“ | çœŸå | æ ¸å¿ƒèƒ½åŠ› | å±€é™æ€§ |
|------|------|----------|--------|
| **Clawdbot** | Claude Computer Use | æ§åˆ¶é”®é¼ ï¼Œæ“ä½œæ—  API è½¯ä»¶ | æ— é’±åŒ…ã€æ— å•†ä¸šä¸»ä½“ |
| **Clauld Cowork** | Claude for Work / Projects | çŸ¥è¯†åº“åä½œï¼Œå›¢é˜Ÿå…±äº«ä¸Šä¸‹æ–‡ | æ— äº¤æ˜“èƒ½åŠ›ã€æ— èµ„äº§ç®¡ç† |

### 2.2 Agentrix HQ å·®å¼‚åŒ–å®šä½
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     AI Agent ç”Ÿæ€                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Claude     â”‚     â”‚  GPT-4o     â”‚     â”‚  Gemini     â”‚   â”‚
â”‚  â”‚  (Brain)    â”‚     â”‚  (Brain)    â”‚     â”‚  (Brain)    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚         â”‚                   â”‚                   â”‚          â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                             â”‚                              â”‚
â”‚                      â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚                      â”‚  Agentrix   â”‚                       â”‚
â”‚                      â”‚  HQ (Body)  â”‚  â—„â”€â”€ æˆ‘ä»¬çš„ä½ç½®       â”‚
â”‚                      â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚                       â”‚
â”‚                      â”‚  â€¢ Wallet   â”‚                       â”‚
â”‚                      â”‚  â€¢ Payments â”‚                       â”‚
â”‚                      â”‚  â€¢ Products â”‚                       â”‚
â”‚                      â”‚  â€¢ CRM      â”‚                       â”‚
â”‚                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
**æ ¸å¿ƒç»“è®º**: HQ ä¸ä¸ Claude ç«äº‰ "æ™ºåŠ›"ï¼Œè€Œæ˜¯æä¾› Claude ç¼ºå¤±çš„ "å•†ä¸šèº«ä½“"ã€‚

---

## 3. å½“å‰ç³»ç»Ÿè¯Šæ–­

### 3.1 HQ æ¨¡å—ç°çŠ¶ (`backend/src/modules/hq/`)
| æ–‡ä»¶ | åŠŸèƒ½ | çŠ¶æ€ |
|------|------|------|
| `hq.controller.ts` | èŠå¤©æ¥å£ã€çŸ¥è¯†åº“ã€Workspace IDE | âš ï¸ åŠŸèƒ½å•è–„ |
| `hq.service.ts` | RAG çŸ¥è¯†åº“å¤„ç† | âœ… å¯å¤ç”¨ |
| `developer.service.ts` | æ–‡ä»¶è¯»å†™ã€ä»£ç æœç´¢ã€å‘½ä»¤æ‰§è¡Œ | âœ… æ ¸å¿ƒèƒ½åŠ› |
| `rag.service.ts` | æœ¬åœ°æ–‡æ¡£å‘é‡åŒ– | âœ… å¯å¤ç”¨ |

### 3.2 Admin æ¨¡å—ç°çŠ¶ (`backend/src/modules/admin/`)
| Service | åŠŸèƒ½ | è¿ç§»ä¼˜å…ˆçº§ |
|---------|------|------------|
| `user-management.service.ts` | ç”¨æˆ· CRUDã€çŠ¶æ€ç®¡ç† | ğŸ”´ P0 |
| `merchant-management.service.ts` | å•†æˆ·å®¡æ ¸ã€KYC | ğŸ”´ P0 |
| `risk-management.service.ts` | é£æ§æ‹¦æˆªã€å‘Šè­¦ | ğŸ”´ P0 |
| `product-management.service.ts` | äº§å“å®¡æ ¸ã€ä¸Šä¸‹æ¶ | ğŸŸ¡ P1 |
| `fund-path-management.service.ts` | èµ„é‡‘æµå‘è¿½è¸ª | ğŸŸ¡ P1 |
| `support-ticket.service.ts` | å·¥å•ç³»ç»Ÿ | ğŸŸ¢ P2 |
| `marketing-management.service.ts` | è¥é”€æ´»åŠ¨ç®¡ç† | ğŸŸ¢ P2 |
| `system-management.service.ts` | ç³»ç»Ÿé…ç½® | ğŸŸ¢ P2 |
| `developer-management.service.ts` | å¼€å‘è€…å®¡æ ¸ | ğŸŸ¢ P2 |
| `promoter-management.service.ts` | æ¨å¹¿å‘˜ç®¡ç† | ğŸŸ¢ P2 |

### 3.3 UI ç°çŠ¶å¯¹æ¯”
| é¡¹ç›® | æŠ€æœ¯æ ˆ | é—®é¢˜ |
|------|--------|------|
| `frontend/pages/admin/*` | Next.js 13 (Pages Router) | ä¸ä¸»ç«™è€¦åˆï¼Œç»„ä»¶ä¸ç‹¬ç«‹ |
| `hq-console/` | Next.js 14 (App Router) | åŠŸèƒ½ç©ºæ´ï¼Œä»…æœ‰èŠå¤©æ¡† |

---

## 4. ç›®æ ‡æ¶æ„è®¾è®¡

### 4.1 ä¸‰å±‚ UI æ¶æ„
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 1: The Bridge (èˆ°æ¡¥/æ€»è§ˆ)                            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚  â€¢ ç³»ç»ŸçŠ¶æ€ç¯ (Payment/Agent/Revenue)                      â”‚
â”‚  â€¢ æƒ…æŠ¥æµ (Alert Feed)                                     â”‚
â”‚  â€¢ å…³é”®æŒ‡æ ‡å¡ç‰‡ (KPI Cards)                                 â”‚
â”‚  â€¢ è¿è¥æ¨¡å¼å¼€å…³ (Manual âŸ· Automated)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Layer 2: The Staff (å‘˜å·¥/ä½œæˆ˜å®¤)                           â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚  â€¢ Agent èŠ±åå†Œ (Sales-01, Dev-02, HR-01...)               â”‚
â”‚  â€¢ æŒ‡ä»¤æ§åˆ¶å° (Chat + Artifact Canvas)                      â”‚
â”‚  â€¢ ä»»åŠ¡é˜Ÿåˆ— (Task Queue with Progress)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Layer 3: The Engine Room (æœºæˆ¿/æ‰‹åŠ¨ç®¡ç†)                    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚  â€¢ å•†æˆ·æ•°æ®åº“ (Merchant CRUD)                               â”‚
â”‚  â€¢ è´¢åŠ¡è´¦æœ¬ (Transaction Logs)                              â”‚
â”‚  â€¢ äº§å“ç›®å½• (Product Catalog)                               â”‚
â”‚  â€¢ ç”¨æˆ·ç®¡ç† (User Management)                               â”‚
â”‚  â€¢ é£æ§ä¸­å¿ƒ (Risk Dashboard)                                â”‚
â”‚  (ä»¥ Sheet/Drawer å½¢å¼æŒ‰éœ€åŠ è½½)                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 åç«¯æœåŠ¡æ¶æ„
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         HQ Pilot (Port 3005)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  HQ Module    â”‚  â”‚  Admin Module â”‚  â”‚  MCP Server   â”‚        â”‚
â”‚  â”‚  (Chat/RAG)   â”‚  â”‚  (Migrated)   â”‚  â”‚  (Tools)      â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚          â”‚                  â”‚                  â”‚                 â”‚
â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                             â”‚                                    â”‚
â”‚                      â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”                             â”‚
â”‚                      â”‚  BullMQ     â”‚  â—„â”€â”€ å¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ—            â”‚
â”‚                      â”‚  (Redis)    â”‚                             â”‚
â”‚                      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                             â”‚
â”‚                             â”‚                                    â”‚
â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚          â–¼                  â–¼                  â–¼                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚   â”‚ Watchdog    â”‚   â”‚ Cron Jobs   â”‚   â”‚ WebSocket   â”‚           â”‚
â”‚   â”‚ (Health)    â”‚   â”‚ (Scheduled) â”‚   â”‚ (Realtime)  â”‚           â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. UI é‡æ„æ–¹æ¡ˆ

### 5.1 æŠ€æœ¯æ ˆé€‰å‹
| å±‚çº§ | é€‰å‹ | ç†ç”± |
|------|------|------|
| Framework | **Next.js 14 (App Router)** | RSC æ”¯æŒï¼Œç›´è¿ DBï¼Œå‡å°‘ API å»¶è¿Ÿ |
| UI Library | **shadcn/ui + Tailwind** | AI å‹å¥½ï¼Œé«˜åº¦å¯å®šåˆ¶ |
| State (Client) | **Zustand** | è½»é‡ï¼ŒDevTools æ”¯æŒ |
| State (Server) | **TanStack Query** | è‡ªåŠ¨ç¼“å­˜ã€è½®è¯¢ã€ä¹è§‚æ›´æ–° |
| Charts | **Recharts** | ä¸ shadcn é£æ ¼å¥‘åˆ |
| Icons | **Lucide React** | å·²å®‰è£…ï¼Œç»Ÿä¸€é£æ ¼ |

### 5.2 ç›®å½•ç»“æ„è§„åˆ’
```
hq-console/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ page.tsx                 # Layer 1: Bridge (é¦–é¡µ)
â”‚   â”‚   â”œâ”€â”€ staff/
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx             # Layer 2: Staff (ä½œæˆ˜å®¤)
â”‚   â”‚   â”œâ”€â”€ engine/
â”‚   â”‚   â”‚   â”œâ”€â”€ merchants/page.tsx   # Layer 3: å•†æˆ·ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ users/page.tsx       # Layer 3: ç”¨æˆ·ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ products/page.tsx    # Layer 3: äº§å“ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ finance/page.tsx     # Layer 3: è´¢åŠ¡è´¦æœ¬
â”‚   â”‚   â”‚   â””â”€â”€ risk/page.tsx        # Layer 3: é£æ§ä¸­å¿ƒ
â”‚   â”‚   â””â”€â”€ layout.tsx               # å…¨å±€å¸ƒå±€ (ä¾§è¾¹æ  + Header)
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ ui/                      # shadcn åŸºç¡€ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ bridge/                  # Layer 1 ä¸“ç”¨ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ StatusCard.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ AlertFeed.tsx
â”‚   â”‚   â”‚   â””â”€â”€ KpiGrid.tsx
â”‚   â”‚   â”œâ”€â”€ staff/                   # Layer 2 ä¸“ç”¨ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ AgentRoster.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ CommandConsole.tsx
â”‚   â”‚   â”‚   â””â”€â”€ ArtifactCanvas.tsx
â”‚   â”‚   â””â”€â”€ engine/                  # Layer 3 ä¸“ç”¨ç»„ä»¶
â”‚   â”‚       â”œâ”€â”€ DataTable.tsx        # é€šç”¨è¡¨æ ¼ (å¤ç”¨)
â”‚   â”‚       â”œâ”€â”€ MerchantSheet.tsx
â”‚   â”‚       â””â”€â”€ UserSheet.tsx
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”œâ”€â”€ utils.ts                 # cn() ç­‰å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ api.ts                   # Axios å®ä¾‹
â”‚   â”‚   â””â”€â”€ store.ts                 # Zustand Store
â”‚   â””â”€â”€ hooks/
â”‚       â”œâ”€â”€ useAgents.ts
â”‚       â”œâ”€â”€ useDashboard.ts
â”‚       â””â”€â”€ useAlerts.ts
â””â”€â”€ package.json
```

### 5.3 å…³é”®é¡µé¢è®¾è®¡

#### Layer 1: Bridge (é¦–é¡µ)
å·²å®ç°åŸå‹ï¼Œè§ `hq-console/src/app/page.tsx`ã€‚
**å¾…è¡¥å……**:
- [ ] æ¥å…¥çœŸå® API æ•°æ®
- [ ] æ·»åŠ  WebSocket å®æ—¶åˆ·æ–°
- [ ] æ·»åŠ  "è¿è¥æ¨¡å¼" åˆ‡æ¢å¼€å…³

#### Layer 2: Staff (ä½œæˆ˜å®¤)
**å¸ƒå±€**: ä¸‰æ å¼
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Agent Roster  â”‚  Command Console  â”‚  Artifact Canvas   â”‚
â”‚  (20%)         â”‚  (40%)            â”‚  (40%)             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  [S01] Sales   â”‚  > è®© S01 å‘æ¨æ–‡   â”‚  [Draft Tweet]     â”‚
â”‚  [D02] Dev     â”‚                   â”‚  "Agentrix æ–°åŠŸèƒ½..."â”‚
â”‚  [H01] Core    â”‚  Agent: æ­£åœ¨ç”Ÿæˆ... â”‚                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Layer 3: Engine Room (æœºæˆ¿)
**å…¥å£**: ä» Layer 1 çš„å¡ç‰‡ç‚¹å‡»è¿›å…¥ï¼Œæˆ–ä»ä¾§è¾¹æ å¯¼èˆªã€‚
**ç»„ä»¶**: å¤ç”¨ shadcn `DataTable` + `Sheet`ã€‚

---

## 6. åç«¯é‡æ„æ–¹æ¡ˆ

### 6.1 API è·¯ç”±æ•´åˆ
å°† Admin API è¿ç§»åˆ° HQ å‘½åç©ºé—´ä¸‹ï¼š
| åŸè·¯ç”± | æ–°è·¯ç”± | è¯´æ˜ |
|--------|--------|------|
| `GET /admin/users` | `GET /hq/engine/users` | ç”¨æˆ·åˆ—è¡¨ |
| `GET /admin/merchants` | `GET /hq/engine/merchants` | å•†æˆ·åˆ—è¡¨ |
| `GET /admin/risk/*` | `GET /hq/engine/risk/*` | é£æ§æ•°æ® |
| `GET /admin/products` | `GET /hq/engine/products` | äº§å“åˆ—è¡¨ |
| `GET /admin/fund-paths` | `GET /hq/engine/fund-paths` | èµ„é‡‘æµå‘ |

### 6.2 æ–°å¢ Dashboard API
```typescript
// GET /hq/dashboard/stats
{
  revenue24h: 1234.56,
  revenueChange: 0.201, // +20.1%
  activeAgents: 4,
  totalAgents: 5,
  activeMerchants: 128,
  newMerchants24h: 3,
  riskLevel: 'LOW' | 'MEDIUM' | 'HIGH'
}

// GET /hq/dashboard/alerts
{
  alerts: [
    { id: 1, type: 'risk', title: '...', message: '...', timestamp: '...' },
    ...
  ]
}

// GET /hq/agents/status
{
  agents: [
    { id: 'S01', name: 'Sales-01', status: 'running', task: '...', progress: 45 },
    ...
  ]
}
```

### 6.3 MCP Server é›†æˆ
å°†æ ¸å¿ƒä¸šåŠ¡èƒ½åŠ›å°è£…ä¸º MCP Toolsï¼Œä¾› Claude è°ƒç”¨ï¼š
```typescript
// MCP Tools æ¸…å•
{
  tools: [
    { name: 'hq_create_product', description: 'åˆ›å»ºæ–°äº§å“' },
    { name: 'hq_refund_order', description: 'é€€æ¬¾è®¢å• (éœ€æˆæƒ)' },
    { name: 'hq_ban_user', description: 'å°ç¦ç”¨æˆ· (éœ€æˆæƒ)' },
    { name: 'hq_get_revenue', description: 'è·å–è¥æ”¶æ•°æ®' },
    { name: 'hq_search_merchants', description: 'æœç´¢å•†æˆ·' },
  ]
}
```

---

## 7. Admin åŠŸèƒ½è¿ç§»æ¸…å•

### 7.1 P0 (å¿…é¡»è¿ç§» - Week 1-2)
| åŠŸèƒ½ | åŸä½ç½® | æ–°ä½ç½® | è´Ÿè´£ |
|------|--------|--------|------|
| ç”¨æˆ·åˆ—è¡¨/è¯¦æƒ… | `admin/users.tsx` | `engine/users/page.tsx` | FE |
| ç”¨æˆ·çŠ¶æ€ç®¡ç† | `UserManagementService` | `HqUserService` | BE |
| å•†æˆ·åˆ—è¡¨/å®¡æ ¸ | `admin/merchants.tsx` | `engine/merchants/page.tsx` | FE |
| å•†æˆ· KYC å®¡æ‰¹ | `MerchantManagementService` | `HqMerchantService` | BE |
| é£æ§å‘Šè­¦åˆ—è¡¨ | `admin/risk.tsx` | `engine/risk/page.tsx` | FE |
| é£æ§æ‹¦æˆªè¯¦æƒ… | `RiskManagementService` | `HqRiskService` | BE |

### 7.2 P1 (é‡è¦ - Week 3)
| åŠŸèƒ½ | åŸä½ç½® | æ–°ä½ç½® |
|------|--------|--------|
| äº§å“å®¡æ ¸/ä¸Šä¸‹æ¶ | `admin/products.tsx` | `engine/products/page.tsx` |
| èµ„é‡‘æµå‘è¿½è¸ª | `admin/fund-paths.tsx` | `engine/finance/page.tsx` |
| å¼€å‘è€…ç®¡ç† | `admin/developers.tsx` | `engine/developers/page.tsx` |

### 7.3 P2 (å¢å¼º - Week 4+)
| åŠŸèƒ½ | åŸä½ç½® | æ–°ä½ç½® |
|------|--------|--------|
| å·¥å•ç³»ç»Ÿ | `admin/tickets.tsx` | `engine/tickets/page.tsx` |
| è¥é”€æ´»åŠ¨ | `admin/marketing.tsx` | `engine/marketing/page.tsx` |
| æ¨å¹¿å‘˜ç®¡ç† | `admin/promoters.tsx` | `engine/promoters/page.tsx` |
| ç³»ç»Ÿé…ç½® | `admin/system.tsx` | `engine/system/page.tsx` |

---

## 8. è¯¦ç»†å®æ–½è®¡åˆ’

### Phase 1: åŸºç¡€è®¾æ–½ (Week 1)
**ç›®æ ‡**: æ­å»º HQ V2 éª¨æ¶ï¼Œè·‘é€šå…¨é“¾è·¯ã€‚

| Day | ä»»åŠ¡ | äº§å‡º |
|-----|------|------|
| D1 | å®‰è£… shadcn ä¾èµ–ï¼Œé…ç½® Tailwind | `components.json`, æ›´æ–° `tailwind.config.js` |
| D1 | åˆ›å»º `lib/utils.ts`, åŸºç¡€ UI ç»„ä»¶ | `button`, `card`, `badge` ç­‰ |
| D2 | å®ç° Bridge é¡µé¢çœŸå®å¸ƒå±€ | `app/page.tsx` å®Œå–„ |
| D2 | å®ç°å…¨å±€ Layout (ä¾§è¾¹æ ) | `app/layout.tsx` |
| D3 | åç«¯: åˆ›å»º `/hq/dashboard/*` API | `hq.controller.ts` æ‰©å±• |
| D3 | å‰ç«¯: æ¥å…¥ Dashboard API | `hooks/useDashboard.ts` |
| D4 | å®ç° Alert Feed ç»„ä»¶ | `components/bridge/AlertFeed.tsx` |
| D5 | é›†æˆæµ‹è¯•ï¼Œä¿®å¤é—®é¢˜ | å¯è®¿é—®çš„ Bridge é¡µé¢ |

### Phase 2: Staff ä½œæˆ˜å®¤ (Week 2)
**ç›®æ ‡**: å®ç° Agent æŒ‡æŒ¥åŠŸèƒ½ã€‚

| Day | ä»»åŠ¡ | äº§å‡º |
|-----|------|------|
| D1 | è®¾è®¡ Staff é¡µé¢å¸ƒå±€ | `app/staff/page.tsx` éª¨æ¶ |
| D2 | å®ç° Agent Roster ç»„ä»¶ | `components/staff/AgentRoster.tsx` |
| D3 | å®ç° Command Console (Chat) | `components/staff/CommandConsole.tsx` |
| D4 | å®ç° Artifact Canvas | `components/staff/ArtifactCanvas.tsx` |
| D5 | åç«¯: Agent çŠ¶æ€ API | `GET /hq/agents/status` |

### Phase 3: Engine Room è¿ç§» (Week 3-4)
**ç›®æ ‡**: å®Œæˆ Admin åŠŸèƒ½è¿ç§»ã€‚

| Week | ä»»åŠ¡ |
|------|------|
| W3-D1~D2 | è¿ç§»ç”¨æˆ·ç®¡ç† (`engine/users`) |
| W3-D3~D4 | è¿ç§»å•†æˆ·ç®¡ç† (`engine/merchants`) |
| W3-D5 | è¿ç§»é£æ§ä¸­å¿ƒ (`engine/risk`) |
| W4-D1~D2 | è¿ç§»äº§å“ç®¡ç† (`engine/products`) |
| W4-D3~D4 | è¿ç§»è´¢åŠ¡è´¦æœ¬ (`engine/finance`) |
| W4-D5 | é›†æˆæµ‹è¯•ï¼Œæƒé™æ ¡éªŒ |

### Phase 4: è‡ªåŠ¨åŒ–å¾ªç¯ (Week 5+)
**ç›®æ ‡**: å®ç° 24/7 æ— äººè¿è¥ã€‚

| ä»»åŠ¡ | è¯´æ˜ |
|------|------|
| BullMQ é›†æˆ | æŒä¹…åŒ–ä»»åŠ¡é˜Ÿåˆ— |
| Cron Jobs | å®šæ—¶å·¡æ£€ (å¦‚: æ¯å°æ—¶æ£€æŸ¥ Twitter çƒ­ç‚¹) |
| Watchdog | Agent å¥åº·ç›‘æ§ï¼Œè‡ªåŠ¨é‡å¯ |
| WebSocket | å®æ—¶æ¨é€å‘Šè­¦åˆ° Bridge |
| ç§»åŠ¨ç«¯é€‚é… | CEO éšæ—¶ "æŸ¥æˆ¿" |

---

## 9. é£é™©ä¸ç¼“è§£

| é£é™© | ç­‰çº§ | ç¼“è§£æªæ–½ |
|------|------|----------|
| Admin API å˜æ›´å¯¼è‡´å‰ç«¯å…¼å®¹é—®é¢˜ | ğŸŸ¡ ä¸­ | ä¿æŒæ—§ API å…¼å®¹ 2 å‘¨è¿‡æ¸¡æœŸ |
| shadcn ç»„ä»¶ä¸æ»¡è¶³å¤æ‚è¡¨æ ¼éœ€æ±‚ | ğŸŸ¡ ä¸­ | å¤‡é€‰: TanStack Table ç›´æ¥ä½¿ç”¨ |
| Agent è‡ªåŠ¨æ“ä½œå¼•å‘èµ„é‡‘æŸå¤± | ğŸ”´ é«˜ | è®¾ç½® Daily Spending Limit + äººå·¥å®¡æ‰¹å¤§é¢ |
| å›¢é˜Ÿä¸ç†Ÿæ‚‰ App Router | ğŸŸ¢ ä½ | æä¾› Next.js 14 åŸ¹è®­æ–‡æ¡£ |

---

## 10. éªŒæ”¶æ ‡å‡†

### 10.1 Phase 1 å®Œæˆæ ‡å‡†
- [x] è®¿é—® `http://localhost:4000` å¯çœ‹åˆ° Bridge é¡µé¢
- [x] KPI æ•°æ®ä»åç«¯ API å®æ—¶è·å–
- [x] Alert Feed æ˜¾ç¤ºæœ€è¿‘ 10 æ¡å‘Šè­¦

### 10.2 Phase 2 å®Œæˆæ ‡å‡†
- [x] å¯åœ¨ Staff é¡µé¢ä¸ Agent å¯¹è¯
- [x] Agent è¿”å›å†…å®¹åœ¨ Artifact Canvas æ¸²æŸ“

### 10.3 Phase 3 å®Œæˆæ ‡å‡†
- [x] æ‰€æœ‰ P0 åŠŸèƒ½åœ¨ Engine Room å¯ç”¨
- [ ] æ“ä½œè®°å½•å†™å…¥å®¡è®¡æ—¥å¿— (TODO)

### 10.4 Phase 4 å®Œæˆæ ‡å‡†
- [x] WebSocket Gateway æ”¯æŒå®æ—¶æ¨é€
- [x] Watchdog æœåŠ¡è‡ªåŠ¨ç›‘æ§ Agent å’Œé£é™©
- [ ] CEO æ‰‹æœºç«¯å¯æ¥æ”¶é‡è¦å‘Šè­¦æ¨é€ (TODO: ç§»åŠ¨ç«¯é€‚é…)

---

## é™„å½• A: å·²å®Œæˆå·¥ä½œ

| æ—¶é—´ | å·¥ä½œ | æ–‡ä»¶ |
|------|------|------|
| 2026-01-28 | åˆ›å»º PRD æ–‡æ¡£ | `AGENTRIX_HQ_REFACTOR_V2.md` |
| 2026-01-28 | å®‰è£… shadcn ä¾èµ– | `hq-console/package.json` |
| 2026-01-28 | åˆ›å»ºåŸºç¡€ UI ç»„ä»¶ | `components/ui/button.tsx`, `card.tsx`, `badge.tsx` |
| 2026-01-28 | åˆ›å»º Bridge åŸå‹ | `app/page.tsx` |
| 2026-01-28 | Phase 1: ä¾§è¾¹æ å¯¼èˆª | `components/layout/Sidebar.tsx` |
| 2026-01-28 | Phase 1: Dashboard API | `hq.controller.ts` (stats, alerts) |
| 2026-01-28 | Phase 1: API Hooks | `hooks/useDashboard.ts`, `lib/api.ts` |
| 2026-01-28 | Phase 1: AlertFeed, KpiGrid | `components/bridge/*.tsx` |
| 2026-01-28 | Phase 2: Staff é¡µé¢ | `app/staff/page.tsx` |
| 2026-01-28 | Phase 2: AgentRoster | `components/staff/AgentRoster.tsx` |
| 2026-01-28 | Phase 2: CommandConsole | `components/staff/CommandConsole.tsx` |
| 2026-01-28 | Phase 2: ArtifactCanvas | `components/staff/ArtifactCanvas.tsx` |
| 2026-01-28 | Phase 2: Agent APIs | `hq.controller.ts` (agents/status, command) |
| 2026-01-28 | Phase 3: DataTable | `components/engine/DataTable.tsx` |
| 2026-01-28 | Phase 3: Engine Hooks | `hooks/useEngine.ts` |
| 2026-01-28 | Phase 3: Users é¡µé¢ | `app/engine/users/page.tsx` |
| 2026-01-28 | Phase 3: Merchants é¡µé¢ | `app/engine/merchants/page.tsx` |
| 2026-01-28 | Phase 3: Products é¡µé¢ | `app/engine/products/page.tsx` |
| 2026-01-28 | Phase 3: Risk é¡µé¢ | `app/engine/risk/page.tsx` |
| 2026-01-28 | Phase 3: Finance é¡µé¢ | `app/engine/finance/page.tsx` |
| 2026-01-28 | Phase 3: System é¡µé¢ | `app/engine/system/page.tsx` |
| 2026-01-28 | Phase 3: Engine APIs | `hq.controller.ts` (engine/*) |
| 2026-01-28 | Phase 3: Engine Service | `hq.service.ts` (getEngine*, updateEngine*) |
| 2026-01-28 | Phase 4: WebSocket Gateway | `hq.gateway.ts` |
| 2026-01-28 | Phase 4: Watchdog Service | `hq-watchdog.service.ts` |
| 2026-01-28 | Phase 4: Realtime Hook | `hooks/useRealtime.ts` |

## é™„å½• B: å‚è€ƒèµ„æº

- [shadcn/ui å®˜æ–¹æ–‡æ¡£](https://ui.shadcn.com/)
- [Next.js 14 App Router](https://nextjs.org/docs/app)
- [TanStack Query](https://tanstack.com/query)
- [Zustand](https://github.com/pmndrs/zustand)
- [BullMQ](https://docs.bullmq.io/)
