#!/bin/bash

# é‡Šæ”¾ç«¯å£3000çš„è„šæœ¬

echo "=========================================="
echo "ğŸ”§ é‡Šæ”¾ç«¯å£3000"
echo "=========================================="
echo ""

# æŸ¥æ‰¾å ç”¨3000ç«¯å£çš„è¿›ç¨‹
echo "[1/3] æŸ¥æ‰¾å ç”¨3000ç«¯å£çš„è¿›ç¨‹..."
PID=$(lsof -ti:3000 2>/dev/null)

if [ -z "$PID" ]; then
    echo "âœ… ç«¯å£3000æœªè¢«å ç”¨"
    exit 0
fi

echo "æ‰¾åˆ°è¿›ç¨‹: $PID"

# æ˜¾ç¤ºè¿›ç¨‹ä¿¡æ¯
echo "[2/3] è¿›ç¨‹ä¿¡æ¯:"
ps -p $PID -o pid,cmd 2>/dev/null || echo "æ— æ³•è·å–è¿›ç¨‹ä¿¡æ¯"

# æ€æ­»è¿›ç¨‹
echo "[3/3] æ€æ­»è¿›ç¨‹..."
kill -9 $PID 2>/dev/null

# ç­‰å¾…
sleep 2

# éªŒè¯
if lsof -ti:3000 >/dev/null 2>&1; then
    echo "âŒ ç«¯å£ä»è¢«å ç”¨ï¼Œå°è¯•å¼ºåˆ¶æ€æ­»..."
    kill -9 $PID 2>/dev/null
    sleep 1
else
    echo "âœ… ç«¯å£å·²é‡Šæ”¾"
fi

echo ""
echo "ç°åœ¨å¯ä»¥å¯åŠ¨å‰ç«¯æœåŠ¡äº†:"
echo "  cd paymindfrontend"
echo "  npm run dev"

