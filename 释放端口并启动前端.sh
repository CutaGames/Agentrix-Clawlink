#!/bin/bash

# é‡Šæ”¾ç«¯å£3000å¹¶å¯åŠ¨å‰ç«¯æœåŠ¡

echo "=========================================="
echo "ğŸ”§ é‡Šæ”¾ç«¯å£3000å¹¶å¯åŠ¨å‰ç«¯æœåŠ¡"
echo "=========================================="
echo ""

# æŸ¥æ‰¾å¹¶æ€æ­»å ç”¨3000ç«¯å£çš„è¿›ç¨‹
echo "[1/3] æŸ¥æ‰¾å ç”¨3000ç«¯å£çš„è¿›ç¨‹..."
PID=$(lsof -ti:3000 2>/dev/null)

if [ -n "$PID" ]; then
    echo "æ‰¾åˆ°è¿›ç¨‹: $PID"
    echo "[2/3] æ€æ­»è¿›ç¨‹..."
    kill -9 $PID 2>/dev/null
    sleep 2
    echo "âœ… è¿›ç¨‹å·²ç»ˆæ­¢"
else
    echo "âœ… ç«¯å£3000æœªè¢«å ç”¨"
fi

# æ¸…é™¤ç¼“å­˜
echo "[3/3] æ¸…é™¤Next.jsç¼“å­˜å¹¶å¯åŠ¨æœåŠ¡..."
cd agentrixfrontend
rm -rf .next
echo "âœ… ç¼“å­˜å·²æ¸…é™¤"
echo ""
echo "ğŸš€ å¯åŠ¨å‰ç«¯æœåŠ¡..."
echo "å‰ç«¯å°†åœ¨ http://localhost:3000 å¯åŠ¨"
echo "Agenté¡µé¢: http://localhost:3000/agent"
echo ""
npm run dev

