# 数据库修复命令

## 问题
PostgreSQL 连接错误：`role "arthur" does not exist`

## 解决方案

### 方法1：使用默认用户名 `paymind`（推荐）

```bash
psql -U paymind -d paymind -c "ALTER TABLE agent_sessions ALTER COLUMN \"userId\" DROP NOT NULL;"
```

如果需要密码，会提示输入（默认密码：`paymind_password`）

### 方法2：使用 postgres 超级用户

```bash
psql -U postgres -d paymind -c "ALTER TABLE agent_sessions ALTER COLUMN \"userId\" DROP NOT NULL;"
```

### 方法3：如果数据库名不同

先查看所有数据库：
```bash
psql -U paymind -l
```

然后根据实际数据库名执行：
```bash
psql -U paymind -d [实际数据库名] -c "ALTER TABLE agent_sessions ALTER COLUMN \"userId\" DROP NOT NULL;"
```

### 方法4：在 psql 交互式环境中执行

```bash
# 1. 连接到数据库
psql -U paymind -d paymind

# 2. 在 psql 提示符下执行
ALTER TABLE agent_sessions ALTER COLUMN "userId" DROP NOT NULL;

# 3. 验证
SELECT column_name, is_nullable 
FROM information_schema.columns 
WHERE table_name = 'agent_sessions' AND column_name = 'userId';

# 4. 退出
\q
```

## 验证修复

执行后，`is_nullable` 应该显示为 `YES` 或 `t`（true）

