# 空投与 AutoEarn 产品商业化实施计划

## 📋 概述

本文档制定了将 Agentrix 个人 Agent 的空投发现和 AutoEarn 功能打造成商业化产品的完整实施计划。

**目标**: 在 2026 Q1 实现可商业化运营的空投与自动收益产品，支持多链、真实链上交互，并具备完整的安全机制。

---

## 🎯 产品定位

### 核心价值主张
- **智能发现**: 自动扫描全网空投机会，支持 6+ 主流区块链
- **一键领取**: MPC 钱包自动领取，或提供安全的签名流程
- **风险评估**: 自动评分空投风险，保护用户资产安全
- **收益最大化**: AutoEarn 策略自动化，DeFi 收益聚合

### 目标用户
1. **Web3 新手** (60%): 想参与空投但不懂技术细节
2. **进阶用户** (30%): 希望自动化收益管理
3. **专业玩家** (10%): 需要高级策略和套利工具

---

## 🏗️ 架构设计

### 后端架构
```
┌─────────────────┐
│   Frontend UI   │
└────────┬────────┘
         │ REST API
┌────────▼────────────────────────────────────┐
│        Auto-Earn Controller                 │
├─────────────────────────────────────────────┤
│  AirdropService  │  AutoEarnService         │
│  ├─ AirdropProvider  ├─ StrategyService     │
│  └─ OnchainClaim     └─ TaskExecutor        │
├─────────────────────────────────────────────┤
│  Multi-Chain Support (Chains Config)        │
│  ├─ Ethereum  ├─ BSC   ├─ Polygon           │
│  ├─ Arbitrum  ├─ Base  └─ Solana            │
└─────────────────────────────────────────────┘
         │
    ┌────▼────┐
    │ Database│ (PostgreSQL)
    └─────────┘
```

### 数据流
1. **发现阶段**: AirdropProvider → 多数据源 → 去重 → 风险评分 → 入库
2. **资格阶段**: 检查钱包 → Merkle验证 → Gas估算 → 状态更新
3. **领取阶段**: MPC自动 / 用户签名 → 链上交互 → 交易确认 → 更新状态

---

## 📦 已完成的工作

### ✅ 后端服务
- [x] 多链配置系统 (`chains.config.ts`)
- [x] 空投数据提供者服务 (`AirdropProviderService`)
  - 集成 DeBank、Earndrop、链上数据
- [x] 链上领取服务 (`OnchainClaimService`)
  - Merkle proof 验证
  - Gas 估算
  - 交易构建与提交
- [x] 增强的 `AirdropService`
  - 真实数据发现
  - 资格检查
  - 多模式领取（MPC/用户签名）
- [x] REST API 端点
  - 发现、检查、领取、批量领取

### ✅ 文档
- [x] 商业化部署指南 (`COMMERCIAL_DEPLOYMENT_GUIDE.md`)
- [x] 环境配置说明
- [x] API 文档

---

## 🚧 待完成的工作

### Phase 1: 核心功能完善 (2周)

#### 1.1 后端增强
- [ ] **Solana 支持** (3天)
  - 实现 Solana 钱包查询
  - SPL Token 空投领取
  - Solana RPC 集成
  
- [ ] **MPC 钱包集成** (2天)
  - 安全的私钥管理
  - 自动签名流程
  - KMS 集成（AWS/GCP）

- [ ] **风险评分系统** (2天)
  - 合约审计状态检查
  - 社区信誉评分
  - 黑名单机制

- [ ] **Gas 优化** (2天)
  - 实时 Gas 价格监控
  - 最佳时机提醒
  - 批量领取优化

#### 1.2 前端组件
- [ ] **增强的 AirdropDiscovery** (3天)
  - 多链筛选器
  - 风险标识
  - Gas 费用显示
  - 交易签名流程

- [ ] **钱包签名集成** (2天)
  - MetaMask 支持
  - WalletConnect 支持
  - 交易预览

- [ ] **AutoEarnPanel 升级** (2天)
  - 策略配置UI
  - 收益图表
  - 任务进度追踪

### Phase 2: 数据源与安全 (2周)

#### 2.1 数据源集成
- [ ] **DeBank Pro API** (2天)
  - 配置API密钥
  - 实现钱包资产查询
  - 缓存策略

- [ ] **Earndrop 集成** (1天)
  - 免费API接入
  - 数据格式转换

- [ ] **链上数据爬虫** (3天)
  - Merkle Distributor 合约扫描
  - 历史空投数据收集
  - 定时任务更新

#### 2.2 安全机制
- [ ] **合约验证** (2天)
  - Etherscan API 集成
  - 审计报告查询
  - 合约代码分析

- [ ] **交易模拟** (2天)
  - Tenderly 集成
  - Pre-flight 检查
  - 失败原因分析

- [ ] **资金限额** (1天)
  - 单笔/每日限额
  - 风险阈值
  - 人工审核触发

### Phase 3: AutoEarn 策略引擎 (2周)

#### 3.1 策略类型
- [ ] **DCA (定投)** (2天)
  - 配置界面
  - 定时执行
  - 止盈止损

- [ ] **网格交易** (3天)
  - 参数配置
  - 订单管理
  - 收益计算

- [ ] **套利机器人** (3天)
  - DEX 价格监控
  - 跨链套利路径
  - 自动执行

- [ ] **Copy Trading** (2天)
  - 跟单配置
  - 风险控制
  - 收益分成

#### 3.2 策略优化
- [ ] **回测系统** (2天)
  - 历史数据回放
  - 收益模拟
  - 参数优化

- [ ] **风控引擎** (2天)
  - 最大回撤控制
  - 仓位管理
  - 紧急止损

### Phase 4: 监控与运营 (1周)

#### 4.1 监控系统
- [ ] **业务监控** (2天)
  - 空投发现成功率
  - 领取成功率
  - 平均收益

- [ ] **技术监控** (2天)
  - API 调用成功率
  - RPC 节点健康
  - 数据库性能

- [ ] **告警系统** (1天)
  - 异常检测
  - 邮件/短信通知
  - On-call 机制

#### 4.2 运营工具
- [ ] **用户面板** (2天)
  - 收益报表
  - 交易历史
  - 税务报告

- [ ] **管理后台** (2天)
  - 空投审核
  - 用户管理
  - 数据统计

---

## 🧪 测试计划

### 单元测试 (覆盖率 > 80%)
- [ ] 多链配置测试
- [ ] 空投数据提供者测试
- [ ] Merkle proof 验证测试
- [ ] Gas 估算测试
- [ ] 领取流程测试

### 集成测试
- [ ] 端到端空投流程
- [ ] 多钱包场景
- [ ] 并发领取
- [ ] 失败重试

### 压力测试
- [ ] 1000 用户并发发现
- [ ] 100 笔同时领取
- [ ] RPC 限流测试

### 安全测试
- [ ] 钓鱼合约拦截
- [ ] 私钥泄露模拟
- [ ] SQL 注入
- [ ] XSS 攻击

---

## 📈 上线计划

### 灰度发布 (2周)
1. **内测** (第1周)
   - 开发团队 + 10 名内部用户
   - 测试网环境
   - 收集问题和反馈

2. **小规模公测** (第2周)
   - 邀请 100 名种子用户
   - 主网小额测试
   - 监控关键指标

### 正式上线
- **时间**: 2026 Q1 末
- **目标**: 支持 1000+ 并发用户
- **SLA**: 99.5% 可用性

---

## 💰 成本预算

### 基础设施 (月)
- RPC 节点: $500 (Alchemy/Infura)
- 数据库: $200 (PostgreSQL + Redis)
- 服务器: $800 (AWS/GCP)
- 监控: $100 (Datadog/Grafana)

### API 订阅 (月)
- DeBank Pro: $299
- Arkham: $99
- Tenderly: $50

### 开发成本 (一次性)
- 2 后端工程师 x 6周 = 12 人周
- 1 前端工程师 x 4周 = 4 人周
- 1 测试工程师 x 2周 = 2 人周

### 运营成本 (月)
- 客服: $1000
- 社区运营: $500

**总计首月成本**: ~$15,000  
**月度运营成本**: ~$3,500

---

## 🎯 成功指标

### 产品指标 (3个月后)
- 注册用户 > 10,000
- 活跃用户 > 2,000
- 空投领取成功率 > 90%
- 用户平均收益 > $50/月

### 技术指标
- API 响应时间 < 500ms (P95)
- 系统可用性 > 99.5%
- 领取成功率 > 95%

### 财务指标
- 用户留存率 > 60% (30天)
- 订阅转化率 > 5%
- 单用户获客成本 < $20

---

## 📞 团队与责任

| 角色 | 责任 | 人员 |
|------|------|------|
| 产品经理 | 需求管理、路线图 | TBD |
| 后端 Lead | 架构设计、核心开发 | TBD |
| 前端 Lead | UI/UX、组件开发 | TBD |
| 测试 Lead | 测试策略、质量保障 | TBD |
| DevOps | 部署、监控、运维 | TBD |
| 安全专家 | 安全审计、渗透测试 | TBD |

---

## 📚 相关文档

- [商业化部署指南](./COMMERCIAL_DEPLOYMENT_GUIDE.md)
- [API 文档](../../backend/src/modules/auto-earn/README.md)
- [架构设计](./ARCHITECTURE.md)
- [安全规范](./SECURITY.md)

---

**更新日期**: 2026-01-02  
**版本**: v1.0  
**状态**: 实施中
