# Agentrix Commerce Skill â€” åˆçº¦ä½“ç³» & æ—¶åºå›¾

> æ›´æ–°æ—¶é—´: 2026-02-09 | ä½œè€…: ARCHITECT-01

---

## ä¸€ã€åˆçº¦ä½“ç³»å…¨æ™¯


                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    Agentrix åˆçº¦ä½“ç³» (BSC Testnet)        â”‚
                    â”‚    8 åˆçº¦ Â· 3,908 è¡Œ Solidity             â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚                               â”‚                               â”‚
  â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  æ”¯ä»˜å±‚   â”‚                 â”‚   èº«ä»½/ä¼šè¯å±‚   â”‚             â”‚  å®¡è®¡/æ‰˜ç®¡å±‚   â”‚
  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                               â”‚                               â”‚
  â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
  â”‚PaymentRouterâ”‚             â”‚ERC8004Session   â”‚            â”‚  AuditProof    â”‚
  â”‚ (æ”¯ä»˜è·¯ç”±)  â”‚             â”‚Manager (ä¼šè¯)   â”‚            â”‚ (å®¡è®¡+æ‰˜ç®¡)    â”‚
  â”‚ 286è¡Œ      â”‚             â”‚ 400è¡Œ           â”‚            â”‚ 527è¡Œ          â”‚
  â””â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚    â”‚
â”Œâ”€â”€â”€â”€â”´â”  â”Œâ”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚X402 â”‚  â”‚ AutoPay   â”‚
â”‚216è¡Œâ”‚  â”‚(è‡ªåŠ¨æ”¯ä»˜) â”‚
â””â”€â”€â”€â”€â”€â”˜  â”‚ 269è¡Œ     â”‚
         â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
               â”‚ è°ƒç”¨
         â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Commission â”‚     â”‚CommissionV2  â”‚
         â”‚(åˆ†ä½£V1)    â”‚     â”‚(ç»Ÿä¸€åˆ†æ¶¦V2)  â”‚
         â”‚ 1161è¡Œ     â”‚     â”‚ 462è¡Œ        â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                            â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
                            â”‚ BudgetPool  â”‚
                            â”‚ (é¢„ç®—æ± )    â”‚
                            â”‚ 587è¡Œ       â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


## äºŒã€BSC Testnet éƒ¨ç½²çŠ¶æ€

| # | åˆçº¦ | åœ°å€ | è¡Œæ•° | çŠ¶æ€ |
|---|------|------|------|------|
| 1 | Commission (V1) | `0x5E8023659620DFD296f48f92Da0AE48c9CB443f0` | 1,161 | âœ… å·²éƒ¨ç½² |
| 2 | CommissionV2 | `0xF6c6Ba02761Ca2C8Df3c7D60c8b206fd12a44862` | 466 | âœ… å·²éƒ¨ç½² (2026-02-09 ä¿®å¤ executeSplit èµ„é‡‘æµ bug) |
| 3 | AutoPay | `0xEb9bEa57Fc2924BBdbCD2a8eE81388F4d5B23058` | 269 | âœ… å·²éƒ¨ç½² |
| 4 | PaymentRouter | `0xA72ecad894Ce0659E0be83B5423E765B831E156a` | 286 | âœ… å·²éƒ¨ç½² |
| 5 | X402Adapter | `0x3Fd34DEB93B144e9de3d854b1aBb792dCe9D27e2` | 216 | âœ… å·²éƒ¨ç½² |
| 6 | ERC8004SessionManager | `0xf94E5C7adc5bDA0bD95Cb880c5a5489562f694B7` | 400 | âœ… å·²éƒ¨ç½² |
| 7 | AuditProof | `0xBE398F15aE8c4FbdC727b95E087B8251147Fd99A` | 527 | âœ… å·²éƒ¨ç½² |
| 8 | BudgetPool | `0x8C8D25589b700D0F94b5Ad09aFacEB58595481c9` | 587 | âœ… å·²éƒ¨ç½² |
| 9 | USDC (æµ‹è¯•) | `0xc23453b4842FDc4360A0a3518E2C0f51a2069386` | â€” | âœ… å·²éƒ¨ç½² |

## ä¸‰ã€æ¯ä¸ªåˆçº¦çš„ä½œç”¨

### 1. CommissionV2 (462è¡Œ) â€” ç»Ÿä¸€åˆ†æ¶¦ç»“ç®—

è´¹ç‡ä½“ç³»:
- çº¯é“¾ä¸Š Crypto æ”¯ä»˜: **0% (å…è´¹)**
- On-ramp (Transak ä¹°å¸): +0.1%
- Off-ramp (Transak æç°): +0.1%
- Split åˆ†æ¶¦: 0.3%, æœ€ä½ 0.1 USDC

æ ¸å¿ƒå‡½æ•°:
- `createSplitPlan()` â€” åˆ›å»ºåˆ†è´¦è®¡åˆ’
- `executeSplit()` â€” æ‰§è¡Œåˆ†è´¦
- `claimEarnings()` â€” æå–æ”¶ç›Š
- `batchClaim()` â€” æ‰¹é‡æå–

### 2. BudgetPool (587è¡Œ) â€” é¢„ç®—æ± +é‡Œç¨‹ç¢‘

æ ¸å¿ƒå‡½æ•°:
- `createPool()` â€” åˆ›å»ºé¢„ç®—æ± 
- `fundPool()` â€” å……å€¼ (USDC é”å…¥åˆçº¦)
- `activatePool()` â€” æ¿€æ´»
- `createMilestone()` â€” åˆ›å»ºé‡Œç¨‹ç¢‘
- `startMilestone()` â€” å¼€å§‹
- `submitMilestone()` â€” æäº¤äº¤ä»˜ç‰©
- `approveMilestone()` â€” å®¡æ‰¹
- `releaseMilestone()` â€” é‡Šæ”¾èµ„é‡‘
- `claimEarnings()` â€” å‚ä¸è€…æå–
- `cancelPool()` â€” å–æ¶ˆé€€æ¬¾

### 3. AutoPay (269è¡Œ) â€” è‡ªåŠ¨æ”¯ä»˜æˆæƒ

æ ¸å¿ƒå‡½æ•°:
- `createGrant()` â€” åˆ›å»ºæˆæƒ (å•æ¬¡é™é¢+æ—¥é™é¢+æœ‰æ•ˆæœŸ)
- `revokeGrant()` â€” æ’¤é”€æˆæƒ
- `executeAutoPayment()` â€” æ‰§è¡Œè‡ªåŠ¨æ”¯ä»˜
- `setCommissionContract()` â€” å…³è” Commission åˆ†è´¦
- `setSplitModeEnabled()` â€” å¯ç”¨åˆ†è´¦æ¨¡å¼

### 4. AuditProof (527è¡Œ) â€” å®¡è®¡è¯æ˜/æ‰˜ç®¡é‡Šæ”¾

ä¸‰ç§éªŒè¯æ¨¡å¼: SIGNATURE / HASH_MATCH / MULTISIG

æ ¸å¿ƒå‡½æ•°:
- `createTask()` â€” åˆ›å»ºä»»åŠ¡+æ‰˜ç®¡èµ„é‡‘
- `fundTask()` â€” å……å€¼
- `submitResult()` â€” æäº¤ç»“æœ
- `verifyResult()` â€” éªŒè¯
- `confirmRelease()` â€” é‡Šæ”¾
- `disputeTask()` â€” äº‰è®®
- `resolveDispute()` â€” è§£å†³äº‰è®®
- `refundExpired()` â€” è¿‡æœŸé€€æ¬¾

### 5. Commission V1 (1,161è¡Œ) â€” æ ¸å¿ƒåˆ†ä½£

æœ€å¤§æœ€å¤æ‚çš„åˆçº¦ï¼ŒV5.0 ç‰ˆæœ¬ã€‚
- `registerSkill()` â€” æ³¨å†Œ Skill
- `processPayment()` â€” å¤„ç†æ”¯ä»˜+åˆ†ä½£
- `autoPaySplit()` â€” AutoPay è°ƒç”¨å…¥å£
- `claimEarnings()` â€” æå–æ”¶ç›Š

### 6. PaymentRouter (286è¡Œ) â€” æ”¯ä»˜è·¯ç”±

- `routePayment()` â€” è·¯ç”±æ”¯ä»˜åˆ°æœ€ä¼˜é€šé“
- `setPaymentChannel()` â€” é…ç½®é€šé“

### 7. X402Adapter (216è¡Œ) â€” HTTP 402 åè®®é€‚é…

è®© AI Agent é€šè¿‡ HTTP å¤´éƒ¨å®Œæˆæ”¯ä»˜ã€‚

### 8. ERC8004SessionManager (400è¡Œ) â€” Agent ä¼šè¯ç®¡ç†

ç®¡ç† AI Agent çš„é“¾ä¸Šä¼šè¯å’Œæˆæƒã€‚

---

## å››ã€æ—¶åºå›¾

### æ—¶åºå›¾ 1: åŸºç¡€æ”¯ä»˜ (å…è´¹, ç”¨æˆ·è‡ªä»˜ gas)


â”Œâ”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User â”‚     â”‚ Commerce â”‚     â”‚ Backend  â”‚     â”‚BSC Chain â”‚
â”‚/Agentâ”‚     â”‚  Skill   â”‚     â”‚ Service  â”‚     â”‚          â”‚
â””â”€â”€â”¬â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
   â”‚              â”‚                â”‚                 â”‚
   â”‚ "æ”¯ä»˜10 USDC â”‚ç»™ 0xABC"       â”‚                 â”‚
   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                â”‚                 â”‚
   â”‚              â”‚ createOrder()  â”‚                 â”‚
   â”‚              â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
   â”‚              â”‚  {orderId, paymentLink, QR}      â”‚
   â”‚              â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
   â”‚ è¿”å›æ”¯ä»˜é“¾æ¥  â”‚                â”‚                 â”‚
   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                â”‚                 â”‚
   â”‚              â”‚                â”‚                 â”‚
   â”‚ é’±åŒ…ç­¾åè½¬è´¦  â”‚                â”‚                 â”‚
   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
   â”‚              â”‚                â”‚   txHash        â”‚
   â”‚              â”‚ confirmPayment(orderId, txHash)  â”‚
   â”‚              â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
   â”‚              â”‚                â”‚ verifyTx()      â”‚
   â”‚              â”‚                â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
   â”‚              â”‚                â”‚  confirmed âœ…   â”‚
   â”‚              â”‚                â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
   â”‚ âœ… æ”¯ä»˜å®Œæˆ   â”‚                â”‚                 â”‚
   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                â”‚                 â”‚


ğŸ’° å¹³å°æ”¶å…¥: $0 (å…è´¹åŠŸèƒ½)

---

### æ—¶åºå›¾ 2: åˆ†ä½£æ”¯ä»˜ (CommissionV2, å¹³å°æŠ½ä½£ 0.3%)


â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”
â”‚ User â”‚  â”‚ Commerce â”‚  â”‚ Backend  â”‚  â”‚CommissionV2  â”‚  â”‚ USDC â”‚
â”‚/Agentâ”‚  â”‚  Skill   â”‚  â”‚ Service  â”‚  â”‚  Contract    â”‚  â”‚      â”‚
â””â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”¬â”€â”€â”€â”˜
   â”‚           â”‚             â”‚                â”‚              â”‚
   â”‚ "è°ƒç”¨SkillXâ”‚ 100 USDC"  â”‚                â”‚              â”‚
   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚             â”‚                â”‚              â”‚
   â”‚           â”‚ execute()   â”‚                â”‚              â”‚
   â”‚           â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                â”‚              â”‚
   â”‚           â”‚             â”‚                â”‚              â”‚
   â”‚           â”‚             â”‚ 1. approve(CommissionV2, 100) â”‚
   â”‚           â”‚             â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
   â”‚           â”‚             â”‚                â”‚              â”‚
   â”‚           â”‚             â”‚ 2. executeSplit(planId, 100)  â”‚
   â”‚           â”‚             â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚              â”‚
   â”‚           â”‚             â”‚                â”‚ transferFrom â”‚
   â”‚           â”‚             â”‚                â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
   â”‚           â”‚             â”‚                â”‚              â”‚
   â”‚           â”‚             â”‚                â”‚ åˆ†ä½£è®¡ç®—:     â”‚
   â”‚           â”‚             â”‚                â”‚ â”œâ”€ platform 0.3%
   â”‚           â”‚             â”‚                â”‚ â”œâ”€ merchant 70%
   â”‚           â”‚             â”‚                â”‚ â””â”€ agent 29.7%
   â”‚           â”‚             â”‚                â”‚              â”‚
   â”‚           â”‚             â”‚                â”‚ ç´¯ç§¯ earnings â”‚
   â”‚           â”‚             â”‚                â”‚              â”‚
   â”‚ âœ… Skillæ‰§è¡Œå®Œæˆ         â”‚                â”‚              â”‚
   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚             â”‚                â”‚              â”‚
   â”‚           â”‚             â”‚                â”‚              â”‚
   â”‚ === å„æ–¹æå– ===         â”‚                â”‚              â”‚
   â”‚ merchant  â”‚             â”‚ claimEarnings()â”‚              â”‚
   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚              â”‚
   â”‚           â”‚             â”‚                â”‚ transfer()   â”‚
   â”‚           â”‚             â”‚                â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
   â”‚ âœ… æ”¶åˆ°æ”¶ç›Šâ”‚             â”‚                â”‚              â”‚


ğŸ’° å¹³å°æ”¶å…¥: Split è´¹ 0.3% (æœ€ä½ 0.1 USDC)

---

### æ—¶åºå›¾ 3: AutoPay è‡ªåŠ¨æ”¯ä»˜ (Agent è‡ªä¸»æ”¯ä»˜)


â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”
â”‚ User â”‚  â”‚  Agent   â”‚  â”‚ Backend  â”‚  â”‚ AutoPay  â”‚  â”‚ Commission â”‚  â”‚ USDC â”‚
â””â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”¬â”€â”€â”€â”˜
   â”‚           â”‚             â”‚              â”‚               â”‚            â”‚
   â”‚ â•â•â• ä¸€æ¬¡æ€§æˆæƒ (ç”¨æˆ·ä¸»åŠ¨) â•â•â•           â”‚               â”‚            â”‚
   â”‚           â”‚             â”‚              â”‚               â”‚            â”‚
   â”‚ createGrant(agent, 50/æ¬¡, 200/å¤©, 30å¤©)â”‚               â”‚            â”‚
   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚               â”‚            â”‚
   â”‚ âœ… æˆæƒæˆåŠŸâ”‚             â”‚              â”‚               â”‚            â”‚
   â”‚           â”‚             â”‚              â”‚               â”‚            â”‚
   â”‚ â•â•â• Agent è‡ªåŠ¨æ‰§è¡Œ (æ— éœ€ç”¨æˆ·ç¡®è®¤) â•â•â•  â”‚               â”‚            â”‚
   â”‚           â”‚             â”‚              â”‚               â”‚            â”‚
   â”‚           â”‚ éœ€è¦æ”¯ä»˜30  â”‚              â”‚               â”‚            â”‚
   â”‚           â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚              â”‚               â”‚            â”‚
   â”‚           â”‚             â”‚ executeAutoPayment(user, agent, merchant, 30)
   â”‚           â”‚             â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚               â”‚            â”‚
   â”‚           â”‚             â”‚              â”‚ æ£€æŸ¥æˆæƒ:      â”‚            â”‚
   â”‚           â”‚             â”‚              â”‚ 30 â‰¤ 50 âœ…    â”‚            â”‚
   â”‚           â”‚             â”‚              â”‚ ä»Šæ—¥+30 â‰¤ 200 âœ…           â”‚
   â”‚           â”‚             â”‚              â”‚ æœªè¿‡æœŸ âœ…      â”‚            â”‚
   â”‚           â”‚             â”‚              â”‚               â”‚            â”‚
   â”‚           â”‚             â”‚              â”‚ splitMode?    â”‚            â”‚
   â”‚           â”‚             â”‚              â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚            â”‚
   â”‚           â”‚             â”‚              â”‚               â”‚ åˆ†ä½£å¤„ç†   â”‚
   â”‚           â”‚             â”‚              â”‚               â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
   â”‚           â”‚ âœ… æ”¯ä»˜å®Œæˆ  â”‚              â”‚               â”‚            â”‚
   â”‚           â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚              â”‚               â”‚            â”‚


ğŸ’° Agent è‡ªä¸»æ”¯ä»˜, ç”¨æˆ·åªéœ€ä¸€æ¬¡æˆæƒ

---

### æ—¶åºå›¾ 4: é¢„ç®—æ± å®Œæ•´æµç¨‹ (BudgetPool åˆçº¦)


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”
â”‚  é¡¹ç›®æ–¹   â”‚  â”‚ Commerce â”‚  â”‚ Backend  â”‚  â”‚ BudgetPool â”‚  â”‚ USDC â”‚
â”‚ (Owner)  â”‚  â”‚  Skill   â”‚  â”‚ Service  â”‚  â”‚  Contract  â”‚  â”‚      â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”¬â”€â”€â”€â”˜
     â”‚              â”‚             â”‚               â”‚            â”‚
     â”‚ â•â• é˜¶æ®µ1: åˆ›å»º+å……å€¼+é…ç½®é‡Œç¨‹ç¢‘ â•â•         â”‚            â”‚
     â”‚              â”‚             â”‚               â”‚            â”‚
     â”‚ "åˆ›å»ºé¢„ç®—æ±   â”‚1000 USDC"   â”‚               â”‚            â”‚
     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚             â”‚               â”‚            â”‚
     â”‚              â”‚ createPool()â”‚               â”‚            â”‚
     â”‚              â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚               â”‚            â”‚
     â”‚              â”‚             â”‚               â”‚            â”‚
     â”‚              â”‚             â”‚ approve(BudgetPool, 1000)  â”‚
     â”‚              â”‚             â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
     â”‚              â”‚             â”‚               â”‚            â”‚
     â”‚              â”‚             â”‚ createPool(poolId, 1000)   â”‚
     â”‚              â”‚             â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚            â”‚
     â”‚              â”‚             â”‚               â”‚            â”‚
     â”‚              â”‚             â”‚ fundPool(poolId, 1000)     â”‚
     â”‚              â”‚             â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚            â”‚
     â”‚              â”‚             â”‚               â”‚ transferFrom(owner, 1000)
     â”‚              â”‚             â”‚               â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
     â”‚              â”‚             â”‚               â”‚ ğŸ”’ é”å®š    â”‚
     â”‚              â”‚             â”‚               â”‚            â”‚
     â”‚              â”‚             â”‚ createMilestone("è®¾è®¡", 30%, [A,B], [70%,30%])
     â”‚              â”‚             â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚            â”‚
     â”‚              â”‚             â”‚ createMilestone("å¼€å‘", 50%, [A,C], [60%,40%])
     â”‚              â”‚             â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚            â”‚
     â”‚              â”‚             â”‚ createMilestone("æµ‹è¯•", 20%, [B], [100%])
     â”‚              â”‚             â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚            â”‚
     â”‚              â”‚             â”‚               â”‚            â”‚
     â”‚              â”‚             â”‚ activatePool(poolId)       â”‚
     â”‚              â”‚             â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚            â”‚
     â”‚              â”‚             â”‚               â”‚ status=ACTIVE
     â”‚              â”‚             â”‚               â”‚            â”‚
     â”‚ âœ… é¢„ç®—æ± æ¿€æ´» â”‚             â”‚               â”‚            â”‚
     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚             â”‚               â”‚            â”‚
     â”‚              â”‚             â”‚               â”‚            â”‚
     â”‚ â•â• é˜¶æ®µ2: Worker æ‰§è¡Œ+æäº¤ â•â•             â”‚            â”‚
     â”‚              â”‚             â”‚               â”‚            â”‚
â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”        â”‚             â”‚               â”‚            â”‚
â”‚ Worker A â”‚        â”‚             â”‚               â”‚            â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜        â”‚             â”‚               â”‚            â”‚
     â”‚ "æäº¤é‡Œç¨‹ç¢‘1"â”‚             â”‚               â”‚            â”‚
     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚             â”‚               â”‚            â”‚
     â”‚              â”‚ submitMilestone(poolId, m1, hash)        â”‚
     â”‚              â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚               â”‚            â”‚
     â”‚              â”‚             â”‚ submitMilestoneâ”‚            â”‚
     â”‚              â”‚             â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚            â”‚
     â”‚              â”‚             â”‚               â”‚ status=SUBMITTED
     â”‚              â”‚             â”‚               â”‚            â”‚
     â”‚ â•â• é˜¶æ®µ3: å®¡æ‰¹ â•â•         â”‚               â”‚            â”‚
     â”‚              â”‚             â”‚               â”‚            â”‚
â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”        â”‚             â”‚               â”‚            â”‚
â”‚  é¡¹ç›®æ–¹   â”‚        â”‚             â”‚               â”‚            â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜        â”‚             â”‚               â”‚            â”‚
     â”‚ "å®¡æ‰¹é€šè¿‡ 85åˆ†"             â”‚               â”‚            â”‚
     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚             â”‚               â”‚            â”‚
     â”‚              â”‚ approveMilestone(poolId, m1, 85)         â”‚
     â”‚              â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚               â”‚            â”‚
     â”‚              â”‚             â”‚ approveMilestone           â”‚
     â”‚              â”‚             â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚            â”‚
     â”‚              â”‚             â”‚               â”‚ 85â‰¥70 âœ…   â”‚
     â”‚              â”‚             â”‚               â”‚ APPROVED   â”‚
     â”‚              â”‚             â”‚               â”‚            â”‚
     â”‚ â•â• é˜¶æ®µ4: é‡Šæ”¾èµ„é‡‘ â•â•     â”‚               â”‚            â”‚
     â”‚              â”‚             â”‚               â”‚            â”‚
     â”‚ "é‡Šæ”¾é‡Œç¨‹ç¢‘1"â”‚             â”‚               â”‚            â”‚
     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚             â”‚               â”‚            â”‚
     â”‚              â”‚ releaseMilestone(poolId, m1) â”‚            â”‚
     â”‚              â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚               â”‚            â”‚
     â”‚              â”‚             â”‚ releaseMilestone           â”‚
     â”‚              â”‚             â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚            â”‚
     â”‚              â”‚             â”‚               â”‚ åˆ†é… 300:  â”‚
     â”‚              â”‚             â”‚               â”‚ A=210, B=90â”‚
     â”‚              â”‚             â”‚               â”‚ â†’ pending  â”‚
     â”‚              â”‚             â”‚               â”‚ RELEASED   â”‚
     â”‚              â”‚             â”‚               â”‚            â”‚
     â”‚ âœ… é‡Œç¨‹ç¢‘1é‡Šæ”¾â”‚             â”‚               â”‚            â”‚
     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚             â”‚               â”‚            â”‚
     â”‚              â”‚             â”‚               â”‚            â”‚
     â”‚ â•â• é˜¶æ®µ5: å‚ä¸è€…æå– â•â•   â”‚               â”‚            â”‚
     â”‚              â”‚             â”‚               â”‚            â”‚
â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”        â”‚             â”‚               â”‚            â”‚
â”‚ Worker A â”‚        â”‚             â”‚               â”‚            â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜        â”‚             â”‚               â”‚            â”‚
     â”‚ claimEarningsâ”‚(USDC)       â”‚               â”‚            â”‚
     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚            â”‚
     â”‚              â”‚             â”‚               â”‚ transfer(A, 210)
     â”‚              â”‚             â”‚               â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
     â”‚ âœ… æ”¶åˆ° 210  â”‚             â”‚               â”‚            â”‚
     â”‚              â”‚             â”‚               â”‚            â”‚
     â”‚ â•â• é˜¶æ®µ6: å–æ¶ˆé€€æ¬¾ (å¯é€‰) â•â•              â”‚            â”‚
     â”‚              â”‚             â”‚               â”‚            â”‚
â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”        â”‚             â”‚               â”‚            â”‚
â”‚  é¡¹ç›®æ–¹   â”‚        â”‚             â”‚               â”‚            â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜        â”‚             â”‚               â”‚            â”‚
     â”‚ "å–æ¶ˆé¢„ç®—æ± " â”‚             â”‚               â”‚            â”‚
     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚             â”‚               â”‚            â”‚
     â”‚              â”‚ cancelPool(poolId)           â”‚            â”‚
     â”‚              â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚               â”‚            â”‚
     â”‚              â”‚             â”‚ cancelPool    â”‚            â”‚
     â”‚              â”‚             â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚            â”‚
     â”‚              â”‚             â”‚               â”‚ é€€å› 700   â”‚
     â”‚              â”‚             â”‚               â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
     â”‚              â”‚             â”‚               â”‚ CANCELLED  â”‚
     â”‚ âœ… é€€å› 700  â”‚             â”‚               â”‚            â”‚
     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚             â”‚               â”‚            â”‚


ğŸ’° å¹³å°æ”¶å…¥: é€šè¿‡ CommissionV2 åœ¨é‡Šæ”¾æ—¶æŠ½ä½£

---

### æ—¶åºå›¾ 5: AuditProof å®¡è®¡æ‰˜ç®¡æµç¨‹


â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”
â”‚ User â”‚  â”‚  Agent   â”‚  â”‚ Backend  â”‚  â”‚ AuditProof â”‚  â”‚ USDC â”‚
â””â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”¬â”€â”€â”€â”˜
   â”‚           â”‚             â”‚               â”‚            â”‚
   â”‚ createTask(executor, 100 USDC, SIGNATURE mode)       â”‚
   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚            â”‚
   â”‚           â”‚             â”‚               â”‚            â”‚
   â”‚ fundTask(taskId)        â”‚               â”‚            â”‚
   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚            â”‚
   â”‚           â”‚             â”‚               â”‚ transferFromâ”‚
   â”‚           â”‚             â”‚               â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
   â”‚           â”‚             â”‚               â”‚ ğŸ”’ æ‰˜ç®¡    â”‚
   â”‚           â”‚             â”‚               â”‚            â”‚
   â”‚           â”‚ æ‰§è¡Œä»»åŠ¡... â”‚               â”‚            â”‚
   â”‚           â”‚             â”‚               â”‚            â”‚
   â”‚           â”‚ submitResult(taskId, hash)  â”‚            â”‚
   â”‚           â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚            â”‚
   â”‚           â”‚             â”‚               â”‚ SUBMITTED  â”‚
   â”‚           â”‚             â”‚               â”‚            â”‚
   â”‚ Auditor verifyResult(taskId, signature)â”‚            â”‚
   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚            â”‚
   â”‚           â”‚             â”‚               â”‚ VERIFIED   â”‚
   â”‚           â”‚             â”‚               â”‚            â”‚
   â”‚ confirmRelease(taskId, quality=85)     â”‚            â”‚
   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚            â”‚
   â”‚           â”‚             â”‚               â”‚ transfer(executor)
   â”‚           â”‚             â”‚               â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
   â”‚           â”‚             â”‚               â”‚ RELEASED   â”‚
   â”‚ âœ… èµ„é‡‘é‡Šæ”¾â”‚             â”‚               â”‚            â”‚


---

## äº”ã€AutoPay æˆæƒæ¨¡å‹åˆ†æ

### æˆæƒç»“æ„ (Grant)
solidity
struct Grant {
    address user;        // æˆæƒäºº
    address agent;       // è¢«æˆæƒ Agent
    uint256 singleLimit; // å•æ¬¡é™é¢
    uint256 dailyLimit;  // æ¯æ—¥é™é¢
    uint256 usedToday;   // ä»Šæ—¥å·²ç”¨
    uint256 lastResetDate; // ä¸Šæ¬¡é‡ç½®æ—¥æœŸ
    uint256 expiresAt;   // è¿‡æœŸæ—¶é—´
    bool isActive;       // æ˜¯å¦æ¿€æ´»
}


### å®‰å…¨æœºåˆ¶
- âœ… å•æ¬¡é™é¢: æ¯æ¬¡æ”¯ä»˜ä¸è¶…è¿‡ singleLimit
- âœ… æ—¥é™é¢: æ¯æ—¥ç´¯è®¡ä¸è¶…è¿‡ dailyLimit
- âœ… æœ‰æ•ˆæœŸ: è¶…è¿‡ expiresAt è‡ªåŠ¨å¤±æ•ˆ
- âœ… å¯æ’¤é”€: ç”¨æˆ·éšæ—¶ revokeGrant()
- âœ… åˆ†è´¦é›†æˆ: splitModeEnabled æ—¶è‡ªåŠ¨é€šè¿‡ Commission åˆ†ä½£

### é€‚ç”¨åœºæ™¯
- Agent è°ƒç”¨ä»˜è´¹ API
- Agent è´­ä¹°æ•°æ®/æœåŠ¡
- Agent æ”¯ä»˜åä½œè´¹ç”¨
- è®¢é˜…æœåŠ¡è‡ªåŠ¨ç»­è´¹
- ä»»ä½• Agent è‡ªä¸»æ”¯ä»˜åœºæ™¯

---

## å…­ã€åç«¯å¯¹æ¥çŠ¶æ€

| åˆçº¦ | åç«¯æ¨¡å— | å¯¹æ¥çŠ¶æ€ |
|------|---------|----------|
| Commission V1 | `commission/` | âœ… å·²å¯¹æ¥ |
| CommissionV2 | `commerce/` | âš ï¸ TODO å¾…å¯¹æ¥ |
| BudgetPool | `commerce/budget-pool.service.ts` | âš ï¸ TODO å¾…å¯¹æ¥ (ç¬¬380è¡Œ) |
| AutoPay | `payment/` | âœ… å·²å¯¹æ¥ |
| PaymentRouter | `payment/` | âœ… å·²å¯¹æ¥ |
| X402Adapter | `payment/x402-authorization.service.ts` | âœ… å·²å¯¹æ¥ |
| ERC8004Session | `agent/eas.service.ts` | âœ… å·²å¯¹æ¥ |
| AuditProof | `agent/audit-anchoring.service.ts` | âœ… å·²å¯¹æ¥ |
