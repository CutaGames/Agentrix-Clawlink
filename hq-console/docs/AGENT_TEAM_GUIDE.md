# Agent 团队自动化系统指南

> 最后更新: 2025-02-05

---

## 📊 系统架构


┌─────────────────────────────────────────────────────────────────┐
│                        CEO (老板)                                │
│                  战略指令 / 查看进度 / 审批决策                    │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                    ARCHITECT-01 (我)                            │
│              首席架构师 + Agent CEO + CFO                        │
│         总体规划 / 任务分配 / 预算控制 / 进度监控                  │
└─────────────────────────────────────────────────────────────────┘
                              │
          ┌───────────────────┼───────────────────┐
          ▼                   ▼                   ▼
    ┌───────────┐       ┌───────────┐       ┌───────────┐
    │  DEV-01   │       │ GROWTH-01 │       │RESOURCE-01│
    │ 开发工程师 │       │  增长黑客  │       │ 资源猎手  │
    └───────────┘       └───────────┘       └───────────┘
          │                   │                   │
          ▼                   ▼                   ▼
    ┌───────────┐       ┌───────────┐       ┌───────────┐
    │  OPS-01   │       │   BD-01   │       │  (扩展)   │
    │ 运维工程师 │       │  商务拓展  │       │ 更多Agent │
    └───────────┘       └───────────┘       └───────────┘


---

## 🤖 Agent 团队成员

### ARCHITECT-01 - 首席架构师

| 属性 | 值 |
|------|----|
| **角色** | 首席架构师 + Agent CEO + CFO |
| **模型** | claude-sonnet-4-20250514 (高级) |
| **日预算** | $10.00 |
| **触发频率** | 每15分钟 |

**核心职责：**
1. 系统架构设计 - 设计可扩展、高可用的系统架构
2. 技术决策 - 评估技术选型，做出关键技术决策
3. 团队管理 - 分配任务给其他 Agent
4. 预算控制 - 监控 API 支出，优化成本
5. 进度监控 - 跟踪所有任务进度

---

### DEV-01 - 高级开发工程师

| 属性 | 值 |
|------|----|
| **角色** | 开发工程师 |
| **模型** | deepseek-chat (低成本) |
| **日预算** | $4.00 |
| **触发频率** | 按需 |

**核心职责：**
1. 代码实现 - 根据架构设计实现功能
2. Bug 修复 - 快速定位和修复问题
3. 代码优化 - 提升代码质量和性能
4. 技术文档 - 编写清晰的技术文档
5. 单元测试 - 确保代码质量

**工具权限：** `read_file`, `write_file`, `edit_file`, `run_command`, `fetch_url`

---

### GROWTH-01 - 增长黑客

| 属性 | 值 |
|------|----|
| **角色** | 营销增长 |
| **模型** | claude-3-haiku-20240307 (低成本) |
| **日预算** | $3.00 |
| **触发频率** | 每小时 |

**核心职责：**
1. 内容营销 - 撰写推文、文章、宣传材料
2. 社区运营 - 管理 Twitter、Discord 等社区
3. 用户增长 - 设计和执行增长策略
4. 数据分析 - 分析用户行为和转化数据
5. 品牌建设 - 提升 Agentrix 品牌知名度

**工具权限：** `fetch_url`, `read_file`, `write_file`, `search_knowledge`

---

### RESOURCE-01 - 资源猎手 🆕

| 属性 | 值 |
|------|----|
| **角色** | 资源分析师 |
| **模型** | claude-3-haiku-20240307 (低成本) |
| **日预算** | $3.00 |
| **触发频率** | 每2小时 |

**核心职责：**
1. 寻找云创计划 - AWS/Azure/GCP/阿里云等云厂商的创业扶持
2. 寻找免费 API - AI API 免费额度、开源替代方案
3. 寻找 Grant 机会 - 公链 Grant、基金会 Grant、政府补贴
4. 监控资源动态 - 跟踪各平台的优惠活动和限时福利
5. 成本优化建议 - 分析当前支出，提出节省方案

**工具权限：** `fetch_url`, `search_knowledge`, `read_file`, `write_file`

---

### OPS-01 - 运维工程师

| 属性 | 值 |
|------|----|
| **角色** | DevOps |
| **模型** | claude-3-haiku-20240307 (低成本) |
| **日预算** | $2.00 |
| **触发频率** | 每30分钟 |

**核心职责：**
1. 系统部署 - 部署和更新服务
2. 监控告警 - 监控系统状态，处理告警
3. 性能优化 - 优化系统性能和资源使用
4. 安全维护 - 确保系统安全
5. 备份恢复 - 数据备份和灾难恢复

**工具权限：** `run_command`, `read_file`, `write_file`, `fetch_url`

---

### BD-01 - 商务拓展

| 属性 | 值 |
|------|----|
| **角色** | 商务开发 |
| **模型** | claude-3-haiku-20240307 (低成本) |
| **日预算** | $2.00 |
| **触发频率** | 每4小时 |

**核心职责：**
1. 合作伙伴 - 寻找和维护合作伙伴关系
2. 商业机会 - 发现和评估商业机会
3. 客户关系 - 维护重要客户关系
4. 市场调研 - 了解市场动态和竞争对手
5. 商务谈判 - 参与商务谈判和合同签订

**工具权限：** `fetch_url`, `read_file`, `write_file`, `search_knowledge`

---

## 💰 预算分配

### 每日预算 ($25/天)

| Agent | 预算 | 占比 | 模型 |
|-------|------|------|------|
| ARCHITECT-01 | $10.00 | 40% | claude-sonnet-4 |
| DEV-01 | $4.00 | 16% | deepseek-chat |
| GROWTH-01 | $3.00 | 12% | claude-3-haiku |
| RESOURCE-01 | $3.00 | 12% | claude-3-haiku |
| OPS-01 | $2.00 | 8% | claude-3-haiku |
| BD-01 | $2.00 | 8% | claude-3-haiku |
| 预留 | $1.00 | 4% | - |

### 模型成本参考 (每1K tokens)

| 模型 | 输入 | 输出 | 适用场景 |
|------|------|------|----------|
| claude-sonnet-4 | $0.003 | $0.015 | 复杂决策、架构设计 |
| gpt-4o | $0.005 | $0.015 | 复杂任务 |
| claude-3-haiku | $0.00025 | $0.00125 | 日常任务 |
| gpt-4o-mini | $0.00015 | $0.0006 | 简单任务 |
| deepseek-chat | $0.0001 | $0.0002 | 代码生成 |

### 预算控制策略

1. **80% 警告** - 发送告警，降级使用低成本模型
2. **95% 临界** - 仅允许 ARCHITECT-01 执行
3. **100% 超支** - 停止所有 Agent 执行

---

## ⏰ 自动触发机制

### Tick 系统


┌─────────────────────────────────────────────────────────────────┐
│                     Cron 定时任务                                │
│                                                                 │
│  每15分钟 ──→ /api/hq/tick ──→ ARCHITECT-01 自主思考            │
│                    │                                            │
│                    ├──→ 检查待办任务                             │
│                    ├──→ 分析优先级                               │
│                    ├──→ 分配给其他 Agent                         │
│                    └──→ 记录进度                                 │
└─────────────────────────────────────────────────────────────────┘


### 触发频率

| Agent | 频率 | Cron 表达式 |
|-------|------|-------------|
| ARCHITECT-01 | 每15分钟 | `0 */15 * * * *` |
| OPS-01 | 每30分钟 | `0 */30 * * * *` |
| GROWTH-01 | 每小时 | `0 0 * * * *` |
| RESOURCE-01 | 每2小时 | `0 0 */2 * * *` |
| BD-01 | 每4小时 | `0 0 */4 * * *` |
| DEV-01 | 按需触发 | - |

---

## 📋 任务流程

### 1. 任务创建

typescript
// CEO 或 ARCHITECT-01 创建任务
const task = {
  title: '实现用户登录功能',
  description: '使用 JWT 实现安全的用户登录',
  assignee: 'DEV-01',
  priority: 'high',
  deadline: '2025-02-06',
};


### 2. 任务分配

ARCHITECT-01 根据以下因素分配任务：
- Agent 当前负载
- Agent 技能匹配度
- 任务优先级
- 预算剩余

### 3. 任务执行


待办 (pending) → 进行中 (in_progress) → 完成 (completed)
                         ↓
                    失败 (failed) → 重试


### 4. 进度汇报

每个 Agent 执行完任务后：
1. 更新任务状态
2. 记录执行结果
3. 汇报给 ARCHITECT-01
4. ARCHITECT-01 汇总后通知 CEO

---

## 🔧 API 接口

### Tick 触发

bash
POST /api/hq/tick


### 获取预算状态

bash
GET /api/hq/budget


### 分配任务

bash
POST /api/hq/tasks
{
  "title": "任务标题",
  "assignee": "DEV-01",
  "priority": "high"
}


### 获取 Agent 状态

bash
GET /api/hq/agents


---

## 📁 文件结构


hq-backend/src/hq/tick/
├── tick.module.ts           # Tick 模块
├── tick.service.ts          # Tick 服务（主心跳）
├── tick.controller.ts       # Tick API
├── agent-scheduler.service.ts   # Agent 调度器
├── agent-trigger.service.ts     # Agent 触发器
└── budget-monitor.service.ts    # 预算监控


---

## ✅ 实施进度

| # | 任务 | 状态 | 完成时间 |
|---|------|------|----------|
| 1 | Tick 服务添加 @Cron | ✅ 完成 | 2025-02-05 |
| 2 | 注册 TickModule | ✅ 完成 | 2025-02-05 |
| 3 | Agent 调度器 | ✅ 完成 | 2025-02-05 |
| 4 | Agent 触发器 | ✅ 完成 | 2025-02-05 |
| 5 | 预算监控系统 | ✅ 完成 | 2025-02-05 |
| 6 | Agent Seed 脚本 | ✅ 完成 | 2025-02-05 |
| 7 | 团队文档 | ✅ 完成 | 2025-02-05 |
| 8 | 部署到云端 | ⏳ 待做 | - |
| 9 | 测试验证 | ⏳ 待做 | - |

---

## 🚀 下一步

1. **部署到云端** - 推送代码到东京服务器
2. **运行 Seed 脚本** - 初始化 Agent 团队
3. **启动 Tick 系统** - 开始自动运行
4. **监控运行状态** - 确保系统稳定

---

## 📞 联系方式

如有问题，请联系 ARCHITECT-01 或在 HQ Console 发送指令。
