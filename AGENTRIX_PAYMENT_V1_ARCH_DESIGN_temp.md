# Agentrix 鏀粯 V1.0 鏋舵瀯璁捐鏂规 (Agentrix Payment V1.0 Architecture)

**鐗堟湰**: V1.1  
**鐘舵€?*: 宸茬‘璁?(Confirmed)  
**鏈€鍚庢洿鏂?*: 2026-01-21  
**鏍稿績鐩爣**: 鏋勫缓 AI Agent 鏃朵唬鐨?鏀粯+瀹¤"鍩虹璁炬柦锛岃В鍐?Agent 韬唤鍙獙璇併€佹敮浠樺姩浣滃彲褰掑洜銆佸叏杩囩▼涓嶅彲绡℃敼涓旈殣绉佸弸濂界殑鏍稿績鐥涚偣銆?

> **V1.1 鏇存柊**: 鏂板 Stripe 娉曞竵鐩寸粨閫氶亾锛屾敮鎸?Google Pay / Apple Pay / 淇＄敤鍗＄洿鎺ユ硶甯佹敮浠?

---

## 1. 鎬讳綋鏋舵瀯锛氭贩鍚堝璁℃ā鍨?(Hybrid Audit Model)

鎴戜滑閲囩敤 **"ERC8004 (鎵ц灞? + EAS (璇佹槑灞? + 閫忔槑鏃ュ織 (瀹¤灞?"** 鐨勬贩鍚堟灦鏋勶紝骞宠　 Web3 鐨勫幓涓績鍖栦俊浠讳笌 Web2 鐨勯珮鎬ц兘鎵ц銆?

### 1.1 涓夊眰鏋舵瀯瀹氫箟

| 灞傛 | 鎶€鏈€夊瀷 | 鏍稿績浣滅敤 | 浜や粯鐗?|
| :--- | :--- | :--- | :--- |
| **鎵ц灞?(Execution)** | **ERC8004 + API Key + Stripe** | 澶勭悊鏀粯鎺堟潈銆侀檺棰濇帶鍒朵笌瀹為檯璧勯噾娴佽浆銆?| `PayIntent`, `SessionKey`, `PaymentIntent` |
| **璇佹槑灞?(Attestation)** | **EAS (Ethereum Attestation Service)** | 涓?Agent 韬唤銆侀闄╃瓑绾с€佸悎瑙勭姸鎬佹彁渚涢摼涓婅儗涔︺€?| `UID (Attestation ID)` |
| **瀹¤灞?(Audit)** | **閫忔槑鏃ュ織 (Hash Chaining)** | 璁板綍鍏ㄩ噺浜ゆ槗璇佹嵁閾撅紝閫氳繃鍝堝笇閾炬潯纭繚涓嶅彲绡℃敼銆?| `AuditProof`, `Merkle Root` |

### 1.2 鏀粯閫氶亾鏋舵瀯 馃啎

```
                    鈹屸攢鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹?
                    鈹?           SmartCheckout UI             鈹?
                    鈹? (缁熶竴鏀粯鍏ュ彛锛岀敤鎴蜂粎鐪嬪埌鏀粯鏂瑰紡鍥炬爣)      鈹?
                    鈹斺攢鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹?
                                        鈹?
                                        鈻?
                    鈹屸攢鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹?
                    鈹?         SmartRouter (鏅鸿兘璺敱)          鈹?
                    鈹? 鏍规嵁鍟嗘埛閰嶇疆銆佺敤鎴峰亸濂借嚜鍔ㄩ€夋嫨鏈€浼橀€氶亾     鈹?
                    鈹斺攢鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹?
                                        鈹?
            鈹屸攢鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹攢鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹粹攢鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹攢鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹?
            鈻?              鈻?                      鈻?              鈻?
    鈹屸攢鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹?鈹屸攢鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹?鈹屸攢鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹?鈹屸攢鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹?
    鈹?  QuickPay    鈹?鈹? Wallet Pay   鈹?鈹?   Stripe     鈹?鈹?  Transak     鈹?
    鈹?  (Session)   鈹?鈹?  (Direct)    鈹?鈹? (娉曞竵鐩寸粨)    鈹?鈹?(娉曞竵鈫扷SDC)   鈹?
    鈹斺攢鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹?鈹斺攢鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹?鈹斺攢鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹?鈹斺攢鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹?
            鈹?              鈹?                  鈹?                  鈹?
            鈻?              鈻?                  鈻?                  鈻?
    鈹屸攢鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹?  鈹屸攢鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹?
    鈹?    閾句笂缁撶畻 (ERC8004)         鈹?  鈹?   閾句笅缁撶畻 鈫?鎵归噺鍒嗚处       鈹?
    鈹? 鑷姩鍒嗚处 (鏅鸿兘鍚堢害)            鈹?  鈹?  T+3 缁撶畻缁欏晢鎴?Agent      鈹?
    鈹斺攢鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹?  鈹斺攢鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹?
```

---

## 2. 鏍稿績娴佺▼璁捐

### 2.1 Agent 娉ㄥ唽涓庤韩浠借儗涔?(Identity & Trust)
1. **娉ㄥ唽**: Agent 寮€鍙戣€呭湪 AX 骞冲彴娉ㄥ唽锛岀敓鎴?`agentId` 骞剁粦瀹氬叕閽ャ€?
2. **鑳屼功**: AX 骞冲彴瀵?Agent 杩涜椋庨櫓璇勪及鍚庯紝鍦ㄩ摼涓婂彂甯冧竴鏉?**EAS Attestation**銆?
3. **楠岃瘉**: 浠讳綍绗笁鏂瑰晢鎴峰彲閫氳繃閾句笂 UID 楠岃瘉璇?Agent 鐨勪俊鐢ㄧ瓑绾э紝鏃犻渶淇′换 AX 鏁版嵁搴撱€?

### 2.2 鏀粯鎺堟潈涓庢墽琛?(Authorization & Payment)
1. **鎺堟潈**: 鐢ㄦ埛閫氳繃 ERC8004 绛惧彂 Session Key 缁?Agent銆?
2. **鎵ц**: Agent 鍙戣捣鏀粯锛屾惡甯﹀叾绉侀挜绛惧悕銆?
3. **鏍￠獙**: AX 鍚庣鏍￠獙锛?
   - API Key 鏄惁鏈夋晥銆?
   - Agent 绛惧悕鏄惁鍖归厤銆?
   - ERC8004 Session 鏄惁鍦ㄩ檺棰濆唴銆?

### 2.3 閾句笅瀹¤涓庨摼涓婇敋瀹?(Audit & Anchoring)
1. **璁板綍**: 姣忕瑪浜ゆ槗鐢熸垚 `AuditProof`锛屽寘鍚?`previousProofHash` 褰㈡垚鍝堝笇閾俱€?
2. **鑴辨晱**: 璇佹嵁閾句腑浠呭瓨鍌ㄧ敤鎴?ID 鐨勫搱甯岋紝淇濇姢闅愮銆?
3. **閿氬畾**: 姣忔棩灏嗘墍鏈夎瘉鎹殑 Merkle Root 浣滀负涓€涓?Attestation 鍙戝竷鍒?EAS锛屽疄鐜扳€滀簨鍚庝笉鍙洿鏀光€濄€?

---

## 3. 涓夊眰 ID 浣撶郴闆嗘垚

*   **User ID**: 鏈€缁堟敮浠樹富浣撱€?
*   **Agent ID**: 鍔ㄤ綔鍙戣捣涓讳綋锛堝叧鑱?EAS 淇＄敤璇佹槑锛夈€?
*   **Session ID**: 
    - **閾句笂**: ERC8004 Session ID (鎺堟潈鍑瘉)銆?
    - **閾句笅**: 鏀粯浼氳瘽 ID (瀹¤鍏宠仈閿?銆?

---

## 4. 闅愮淇濇姢绛栫暐 (Privacy-First)

*   **鐩插璁?(Blinded Audit)**: 瀹¤鏃ュ織涓笉瀛樺偍鏄庢枃閽卞寘鍦板潃鎴栧鍚嶃€?
*   **閫夋嫨鎬ф姭闇?*: 瀹¤鍛樹粎鍦ㄨ幏寰楃敤鎴锋巿鏉冿紙鎴栧徃娉曚粙鍏ワ級鏃讹紝閫氳繃 AX 鎻愪緵鐨勭洂鍊硷紙Salt锛夎繕鍘熻韩浠戒俊鎭€?

---

## 5. 瀹炴柦璺嚎鍥?(Roadmap)

### Phase 1: 鏀粯搴曞骇涓庢矙绠?(宸插畬鎴?鉁?
- [x] API Key 浣撶郴 (Sandbox/Prod)銆?
- [x] 鎵樼鏀堕摱鍙颁笌 Webhook 閲嶈瘯銆?
- [x] 鍩虹鍝堝笇閾惧璁￠€昏緫銆?

### Phase 2: Agent 缂栨帓涓?EAS 闆嗘垚 (杩涜涓?馃彈锔?
- [ ] **EAS 妯″潡寮€鍙?*: 闆嗘垚 EAS SDK锛屽疄鐜?Agent 韬唤瀛樿瘉銆?
- [ ] **Agent 鐩存帴鏀粯鎺ュ彛**: `POST /v1/agent/execute_payment`銆?
- [ ] **绛栫暐寮曟搸**: 鑷姩鏍￠獙 ERC8004 闄愰涓?EAS 椋庨櫓绛夌骇銆?

### Phase 3: 鍟嗕笟鍖栦笌鍚堣宸ュ叿 (寰呭惎鍔?鈴?
- [ ] **瀹¤娴忚鍣?*: 渚涘晢鎴?瀹¤鍛橀獙璇佸搱甯岄摼瀹屾暣鎬х殑宸ュ叿銆?
- [ ] **澶氶摼閿氬畾**: 鏀寔灏?Merkle Root 閿氬畾鍒?Solana/BSC銆?
- [ ] **鍒嗘鼎鎶ヨ〃**: 鍩轰簬 Agent 褰掑洜鐨勮嚜鍔ㄥ寲鍒嗚处銆?

