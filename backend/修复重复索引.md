# 修复 agent_stats 表重复索引问题

## 问题说明
`agent_stats` 表的 `agentId` 列同时使用了 `unique: true` 和 `@Index()`，导致创建了重复的索引。

## 解决方案

### 方法1：通过 psql 交互式执行（推荐）

在 WSL 终端中执行：

```bash
cd backend

# 尝试使用 paymind 用户连接（根据你的 .env 配置）
psql -U paymind -d paymind_db -c "DROP INDEX IF EXISTS \"IDX_d08447b22df0d9e98f5d25e6d0\";"

# 如果上面失败，尝试使用 postgres 用户（需要密码）
psql -U postgres -d paymind_db -c "DROP INDEX IF EXISTS \"IDX_d08447b22df0d9e98f5d25e6d0\";"

# 如果还是失败，尝试使用 sudo
sudo -u postgres psql -d paymind_db -c "DROP INDEX IF EXISTS \"IDX_d08447b22df0d9e98f5d25e6d0\";"
```

### 方法2：直接进入 psql 交互式环境

```bash
# 进入 psql
psql -U paymind -d paymind_db
# 或者
psql -U postgres -d paymind_db
# 或者
sudo -u postgres psql -d paymind_db

# 在 psql 中执行：
DROP INDEX IF EXISTS "IDX_d08447b22df0d9e98f5d25e6d0";

# 退出 psql
\q
```

### 方法3：如果表是空的，直接删除表

```bash
# 进入 psql
psql -U paymind -d paymind_db

# 执行
DROP TABLE IF EXISTS agent_stats CASCADE;

# 退出
\q
```

## 修复后

1. 确保 `backend/src/entities/agent-stats.entity.ts` 已经修复（已移除重复的 `@Index()`）
2. 重启后端服务
3. TypeORM 会自动重新创建正确的表结构

## 验证

修复后，可以检查索引：

```sql
-- 查看 agent_stats 表的所有索引
SELECT indexname, indexdef 
FROM pg_indexes 
WHERE tablename = 'agent_stats';
```

应该只看到一个唯一索引（由 `unique: true` 自动创建）。

